{"version":3,"file":"index.mjs","sources":["src/components/DefaultEventRootComponent.tsx","src/utils/createPageMapCoordsToContainer.ts","src/hooks/useClickAndDrag.ts","src/hooks/useMousetrap.ts","src/utils/getSpan.ts","src/utils/createGrid.ts","src/utils/cellToDate.ts","src/utils/createMapCellInfoToRecurringTimeRange.ts","src/utils/createMapDateRangeToCells.ts","src/utils/getEarliestTimeRange.ts","src/components/Cell.tsx","src/context.ts","src/utils/getTextForDateRange.ts","src/components/EventContent.tsx","src/components/RangeBox.tsx","src/components/Schedule.tsx","src/components/IndicatorLine.tsx","src/components/TimeIndicator.tsx","src/components/TimeGridScheduler.tsx"],"sourcesContent":["import React from 'react';\nimport { EventRootProps } from '../types';\n\nexport const DefaultEventRootComponent = React.memo(\n  React.forwardRef<any, EventRootProps>(function DefaultEventRootComponent(\n    {\n      isActive,\n      handleDelete,\n      cellIndex,\n      rangeIndex,\n      classes,\n      disabled,\n      ...props\n    },\n    ref,\n  ) {\n    return <div ref={ref} aria-disabled={disabled} {...props} />;\n  }),\n);\n\nDefaultEventRootComponent.displayName = 'DefaultEventRootComponent';\n","export const createPageMapCoordsToContainer = (container: HTMLElement) => {\n  return (event: React.MouseEvent | MouseEvent | TouchEvent) => {\n    let clientX: number;\n    let clientY: number;\n    let pageX: number;\n    let pageY: number;\n\n    if ('changedTouches' in event) {\n      ({ clientX, clientY, pageX, pageY } = event.changedTouches[0]);\n    } else {\n      ({ clientX, clientY, pageX, pageY } = event);\n    }\n    const { top, left } = container.getBoundingClientRect();\n\n    return {\n      clientX,\n      clientY,\n      pageX,\n      pageY,\n      top,\n      left,\n      x: clientX - left,\n      y: clientY - top,\n    };\n  };\n};\n","import React, { useCallback, useEffect, useState } from 'react';\nimport { fromEvent, merge, Observable, of } from 'rxjs';\nimport {\n  delay,\n  filter,\n  map,\n  mergeMap,\n  startWith,\n  takeUntil,\n  tap,\n} from 'rxjs/operators';\nimport { Rect } from '../types';\nimport { createPageMapCoordsToContainer } from '../utils/createPageMapCoordsToContainer';\n\nconst prevent = tap((e: TouchEvent) => {\n  e.preventDefault();\n  e.stopPropagation();\n});\n\nexport function useClickAndDrag(\n  ref: React.RefObject<HTMLElement>,\n  isDisabled?: boolean,\n) {\n  const [style, setStyle] = useState<React.CSSProperties>({\n    transform: 'translate(0, 0)',\n    width: 0,\n    height: 0,\n  });\n  const [box, setBox] = useState<Rect | null>(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [hasFinishedDragging, setHasFinishedDragging] = useState(false);\n  const container = ref.current;\n\n  useEffect(() => {\n    if (!container || isDisabled) {\n      return;\n    }\n\n    const mapCoordsToContainer = createPageMapCoordsToContainer(container);\n\n    const touchMove$ = fromEvent<TouchEvent>(window, 'touchmove', {\n      passive: false,\n    }).pipe(prevent);\n\n    const touchEnd$ = fromEvent<TouchEvent>(window, 'touchend', {\n      passive: true,\n    });\n\n    const touchStart$ = fromEvent<TouchEvent>(container, 'touchstart', {\n      passive: false,\n    });\n\n    const touchStartWithDelay$ = touchStart$.pipe(\n      mergeMap(start =>\n        of(start).pipe(delay(300), takeUntil(touchMove$), prevent),\n      ),\n    );\n\n    const mouseDown$ = fromEvent<MouseEvent>(container, 'mousedown', {\n      passive: true,\n    }).pipe(filter(event => event.which === 1));\n\n    const mouseMove$ = fromEvent<MouseEvent>(window, 'mousemove', {\n      passive: true,\n    });\n\n    const mouseUp$ = fromEvent<MouseEvent>(window, 'mouseup', {\n      passive: true,\n    });\n\n    const dragStart$ = merge(mouseDown$, touchStartWithDelay$).pipe(\n      map(mapCoordsToContainer),\n    );\n\n    const dragEnd$ = merge(mouseUp$, touchEnd$).pipe(\n      map(mapCoordsToContainer),\n      tap(() => {\n        setIsDragging(false);\n        setHasFinishedDragging(true);\n      }),\n    );\n\n    const move$ = merge(mouseMove$, touchMove$).pipe(map(mapCoordsToContainer));\n\n    const box$: Observable<Rect | null> = dragStart$.pipe(\n      tap(() => {\n        setIsDragging(true);\n        setHasFinishedDragging(false);\n      }),\n      mergeMap(down => {\n        return move$.pipe(\n          startWith(down),\n          map(\n            (move): Rect => {\n              const startX = Math.max(down.x, 0);\n              const startY = Math.max(down.y, 0);\n              const endX = Math.min(move.x, container.scrollWidth);\n              const endY = Math.min(move.y, container.scrollHeight);\n              const top = Math.min(startY, endY);\n              const bottom = Math.max(startY, endY);\n              const left = Math.min(startX, endX);\n              const right = Math.max(startX, endX);\n              const source = '';\n              const title = '';\n\n              return {\n                startX,\n                startY,\n                endX,\n                endY,\n                top,\n                bottom,\n                left,\n                right,\n                width: right - left,\n                height: bottom - top,\n                source,\n                title,\n              };\n            },\n          ),\n          takeUntil(dragEnd$),\n        );\n      }),\n      map(rect => {\n        return rect.width === 0 && rect.height === 0 ? null : rect;\n      }),\n    );\n\n    const style$ = box$.pipe(\n      map(rect => {\n        if (rect !== null) {\n          const { width, height, left, top } = rect;\n          return {\n            transform: `translate(${left}px, ${top}px)`,\n            width,\n            height,\n          };\n        }\n\n        return { display: 'none' };\n      }),\n    );\n\n    const boxSubscriber = box$.subscribe(setBox);\n    const styleSubscriber = style$.subscribe(setStyle);\n\n    return () => {\n      boxSubscriber.unsubscribe();\n      styleSubscriber.unsubscribe();\n    };\n  }, [container, isDisabled]);\n\n  const cancel = useCallback(() => {\n    setIsDragging(false);\n    setHasFinishedDragging(false);\n    setBox(null);\n  }, []);\n\n  return { style, box, isDragging, cancel, hasFinishedDragging };\n}\n","import Mousetrap, { ExtendedKeyboardEvent } from 'mousetrap';\nimport { useEffect, useRef } from 'react';\n\n/**\n * Use mousetrap hook\n *\n * @param handlerKey - A key, key combo or array of combos according to Mousetrap documentation.\n * @param  handlerCallback - A function that is triggered on key combo catch.\n */\nexport function useMousetrap(\n  handlerKey: string | string[],\n  handlerCallback: (e: ExtendedKeyboardEvent, combo: string) => void,\n  elementOrElementRef: typeof document | React.RefObject<Element | null>,\n) {\n  const actionRef = useRef<typeof handlerCallback | null>(null);\n  actionRef.current = handlerCallback;\n  const element =\n    'current' in elementOrElementRef ? elementOrElementRef.current : document;\n\n  useEffect(() => {\n    const instance = new Mousetrap(element as Element);\n\n    instance.bind(handlerKey, (e, combo) => {\n      typeof actionRef.current === 'function' && actionRef.current(e, combo);\n    });\n\n    return () => {\n      instance.unbind(handlerKey);\n    };\n  }, [handlerKey, element]);\n}\n","export const getSpan = (x1: number, x2: number) => 1 + Math.abs(x2 - x1);\n","import clamp from 'lodash/clamp';\nimport floor from 'lodash/floor';\nimport round from 'lodash/round';\nimport { CellInfo, Grid, Rect } from '../types';\nimport { getSpan } from './getSpan';\n\nexport const createGrid = ({\n  totalHeight,\n  totalWidth,\n  numVerticalCells,\n  numHorizontalCells,\n}: {\n  totalHeight: number;\n  totalWidth: number;\n  numVerticalCells: number;\n  numHorizontalCells: number;\n}): Grid => {\n  const cellHeight = totalHeight / numVerticalCells;\n  const cellWidth = totalWidth / numHorizontalCells;\n\n  return {\n    totalHeight,\n    totalWidth,\n    numVerticalCells,\n    numHorizontalCells,\n    cellWidth,\n    cellHeight,\n\n    getRectFromCell(data: CellInfo) {\n      const { endX, startX, endY, startY, spanX, spanY, source, title } = data;\n      const bottom = endY * this.cellHeight;\n      const top = startY * this.cellHeight;\n      const left = startX * this.cellWidth;\n      const right = endX * this.cellWidth;\n      const height = spanY * this.cellHeight;\n      const width = spanX * this.cellWidth;\n\n      return {\n        bottom,\n        top,\n        left,\n        right,\n        height,\n        width,\n        source,\n        title,\n\n        // @TODO: check the math\n        startX: startX * this.cellWidth,\n        endX: endX * this.cellWidth,\n        startY: startY * this.cellHeight,\n        endY: endY * this.cellHeight,\n      };\n    },\n\n    getCellFromRect(data: Rect) {\n      const startX = clamp(\n        floor(data.left / this.cellWidth),\n        0,\n        numHorizontalCells - 1,\n      );\n      const startY = clamp(\n        round(data.top / this.cellHeight),\n        0,\n        numVerticalCells - 1,\n      );\n      const endX = clamp(\n        floor(data.right / this.cellWidth),\n        0,\n        numHorizontalCells - 1,\n      );\n      const endY = clamp(\n        round(data.bottom / this.cellHeight),\n        0,\n        numVerticalCells - 1,\n      );\n      const spanX = clamp(getSpan(startX, endX), 1, numHorizontalCells);\n      const spanY = clamp(getSpan(startY, endY), 1, numVerticalCells);\n      const source = data.source;\n      const title = data.title;\n\n      return {\n        spanX,\n        spanY,\n        startX,\n        startY,\n        endX,\n        endY,\n        source,\n        title,\n      };\n    },\n  };\n};\n","import addDays from 'date-fns/add_days';\nimport addMinutes from 'date-fns/add_minutes';\n\nexport const cellToDate = ({\n  startX,\n  startY,\n  toMin,\n  originDate,\n}: {\n  startX: number;\n  startY: number;\n  toMin: (y: number) => number;\n  toDay: (x: number) => number;\n  originDate: Date;\n}) => addMinutes(addDays(originDate, startX), toMin(startY));\n","import addMinutes from 'date-fns/add_minutes';\nimport compareAsc from 'date-fns/compare_asc';\nimport endOfDay from 'date-fns/end_of_day';\nimport isBefore from 'date-fns/is_before';\nimport min from 'date-fns/min';\nimport range from 'lodash/range';\nimport { DateRange, MapCellInfoToDateRange } from '../types';\nimport { cellToDate } from './cellToDate';\n\nexport type RecurringTimeRange = DateRange[];\n\nexport const createMapCellInfoToRecurringTimeRange: MapCellInfoToDateRange = ({\n  fromY: toMin,\n  fromX: toDay,\n  originDate,\n}) => ({ startX, startY, endX, spanY, source, title }) => {\n  const result = range(startX, endX + 1)\n    .map(i => {\n      const startDate = cellToDate({\n        startX: i,\n        startY,\n        toMin,\n        toDay,\n        originDate,\n      });\n      let endDate = min(\n        addMinutes(startDate, toMin(spanY)),\n        endOfDay(startDate),\n      );\n\n      const range: DateRange = isBefore(startDate, endDate)\n        ? [startDate, endDate, source, title]\n        : [endDate, startDate, source, title];\n\n      return range;\n    })\n    .sort((range1, range2) => compareAsc(range1[0], range2[0]));\n\n  return result;\n};\n","import differenceInDays from 'date-fns/difference_in_days';\nimport differenceInMinutes from 'date-fns/difference_in_minutes';\nimport isEqual from 'date-fns/is_equal';\nimport startOfDay from 'date-fns/start_of_day';\nimport range from 'lodash/range';\nimport { CellInfo, DateRange } from '../types';\nimport { getSpan } from './getSpan';\n\nexport const createMapDateRangeToCells = ({\n  toX = (x: number) => x,\n  toY,\n  numVerticalCells,\n  originDate,\n}: {\n  toX: (day: number) => number;\n  toY: (min: number) => number;\n  numHorizontalCells: number;\n  numVerticalCells: number;\n  originDate: Date;\n}) => ([start, end, source, title]: DateRange): CellInfo[] => {\n  const originOfThisDay = startOfDay(start);\n  const _startX = toX(differenceInDays(start, originDate));\n  const _startY = toY(differenceInMinutes(start, originOfThisDay));\n  const _endX = toX(differenceInDays(end, originDate));\n  const _endY = toY(differenceInMinutes(end, startOfDay(end))) - 1;\n\n  const cells = range(_startX, _endX + 1).map(i => {\n    const startX = i;\n    const endX = i;\n    const atStart = i === _startX;\n    const atEnd = i === _endX;\n    const startY = !atStart ? 0 : _startY;\n    const endY = !atEnd ? numVerticalCells - 1 : _endY;\n    const spanX = getSpan(startX, endX);\n    const spanY = getSpan(startY, endY);\n\n    return {\n      startX,\n      startY,\n      endX,\n      endY,\n      spanX,\n      spanY,\n      source,\n      title,\n    };\n  });\n\n  if (isEqual(end, startOfDay(end))) {\n    cells.pop();\n  }\n\n  return cells;\n};\n","import compareAsc from 'date-fns/compare_asc';\nimport setDay from 'date-fns/set_day';\nimport { DateRange } from '../types';\n\nexport function getEarliestTimeRange(\n  ranges: DateRange[],\n): DateRange | undefined {\n  return [...ranges].sort(([startA], [startB]) =>\n    compareAsc(setDay(startA, 0), setDay(startB, 0)),\n  )[0];\n}\n","import classcat from 'classcat';\nimport getMinutes from 'date-fns/get_minutes';\nimport React from 'react';\nimport { CellInfo, ClassNames, DateRange } from '../types';\n\nexport const Cell = React.memo(function Cell({\n  timeIndex,\n  children,\n  classes,\n  getDateRangeForVisualGrid,\n  onClick,\n}: {\n  timeIndex: number;\n  classes: ClassNames;\n  getDateRangeForVisualGrid(cell: CellInfo): DateRange[];\n  children?(options: { start: Date; isHourStart: boolean }): React.ReactNode;\n  onClick?: React.MouseEventHandler;\n}) {\n  const [[start]] = getDateRangeForVisualGrid({\n    startX: 0,\n    startY: timeIndex,\n    endX: 0,\n    endY: timeIndex + 1,\n    spanX: 1,\n    spanY: 1,\n    source: '',\n    title: '',\n  });\n\n  const isHourStart = getMinutes(start) === 0;\n\n  return (\n    <div role=\"button\" onClick={onClick} className={classcat([classes.cell])}>\n      {children && children({ start, isHourStart })}\n    </div>\n  );\n});\n","import en from 'date-fns/locale/en';\nimport { createContext } from 'react';\n\nexport const SchedulerContext = createContext({ locale: en });\n","import format from 'date-fns/format';\nimport getMinutes from 'date-fns/get_minutes';\nimport isSameDay from 'date-fns/is_same_day';\nimport { DateRange } from '../types';\n\nconst formatTemplate = 'ddd h:mma';\n\nconst dropSame = (\n  dates: [Date, Date],\n  template: string,\n  takeSecond: boolean = false,\n  locale: typeof import('date-fns/locale/en'),\n  title: string,\n): [string, string] => {\n  const [first, second] = dates.map(date => format(date, template, { locale }));\n  if (first !== second || title) {\n    return [first, second];\n  }\n\n  if (takeSecond) {\n    return ['', second];\n  }\n\n  return [first, ''];\n};\n\nconst formatHour = (\n  date: Date,\n  locale: typeof import('date-fns/locale/en'),\n) => {\n  if (getMinutes(date) === 0) {\n    return format(date, 'h', { locale });\n  }\n\n  return format(date, 'h:mm', { locale });\n};\n\ntype Options = {\n  dateRange: DateRange;\n  locale: typeof import('date-fns/locale/en');\n  template?: string;\n  template2?: string;\n  includeDayIfSame?: boolean;\n  title: string;\n};\n\nexport const getFormattedComponentsForDateRange = ({\n  dateRange,\n  locale,\n  template,\n  template2,\n  includeDayIfSame = true,\n  title,\n}: Options) => {\n  const start = dateRange[0];\n  const end = dateRange[1];\n\n  if (isSameDay(start, end) && !template) {\n    const [firstM, secondM] = dropSame([start, end], 'a', true, locale, title);\n    const day = includeDayIfSame ? `${format(start, 'ddd', { locale })} ` : '';\n    return [\n      `${day}${formatHour(start, {\n        locale,\n      })}${firstM}`,\n      `${formatHour(end, { locale })}${secondM}`,\n    ];\n  }\n\n  const startDateStr = format(start, template || formatTemplate, { locale });\n  const endDateStr = format(end, template2 || formatTemplate, { locale });\n\n  return [startDateStr, endDateStr];\n};\n\nexport const getTextForDateRange = (options: Options) => {\n  return getFormattedComponentsForDateRange(options).join(' – ');\n};\n","// @ts-ignore\nimport VisuallyHidden from '@reach/visually-hidden';\nimport classcat from 'classcat';\nimport React, { useContext } from 'react';\nimport { SchedulerContext } from '../context';\nimport { ClassNames, DateRange } from '../types';\nimport {\n  getFormattedComponentsForDateRange,\n  getTextForDateRange,\n} from '../utils/getTextForDateRange';\n\nexport type EventContentProps = {\n  width: number;\n  height: number;\n  classes: ClassNames;\n  dateRange: DateRange;\n  isStart: boolean;\n  isEnd: boolean;\n  title: string;\n  numberOfConflicts: number;\n};\n\nexport const EventContent = React.memo(function EventContent({\n  width,\n  height,\n  classes,\n  dateRange,\n  isStart,\n  isEnd,\n  title,\n  numberOfConflicts,\n}: EventContentProps) {\n  const { locale } = useContext(SchedulerContext);\n  const [start, end] = getFormattedComponentsForDateRange({\n    dateRange,\n    locale,\n    includeDayIfSame: false,\n    title,\n  });\n  const isFifteenMinuteMeeting = height < 25 ? '0 10px' : '';\n\n  return (\n    <div\n      style={{\n        width: width - 4,\n        height: height - 4,\n        padding: isFifteenMinuteMeeting,\n      }}\n      className={classcat([\n        classes['event-content'],\n        {\n          [classes['external-meeting']]: title,\n          [classes['hide-separator']]: numberOfConflicts > 2,\n        },\n      ])}\n    >\n      <VisuallyHidden>\n        {getTextForDateRange({ dateRange, locale, title })}\n      </VisuallyHidden>\n      {numberOfConflicts < 4 && (\n        <React.Fragment>\n          <span aria-hidden className={classes.start}>\n            {isStart && start}\n          </span>\n          {numberOfConflicts < 3 && (\n            <span aria-hidden className={classes.end}>\n              {title ? title : isEnd && end}\n            </span>\n          )}\n        </React.Fragment>\n      )}\n    </div>\n  );\n});\n","import classcat from 'classcat';\nimport invariant from 'invariant';\nimport Resizable, { ResizeCallback } from 're-resizable';\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport Draggable, { DraggableEventHandler } from 'react-draggable';\nimport { useMousetrap } from '../hooks/useMousetrap';\nimport { CellInfo } from '../types';\nimport { DefaultEventRootComponent } from './DefaultEventRootComponent';\nimport { EventContent } from './EventContent';\nimport { ScheduleProps } from './Schedule';\n\nexport const RangeBox = React.memo(function RangeBox({\n  classes,\n  grid,\n  rangeIndex,\n  cellIndex,\n  cellArray,\n  cell,\n  className,\n  onChange,\n  cellInfoToDateRange,\n  isResizable,\n  moveAxis,\n  onActiveChange,\n  onClick,\n  getIsActive,\n  eventContentComponent: EventContentComponent = EventContent,\n  eventRootComponent: EventRootComponent = DefaultEventRootComponent,\n  disabled,\n  numberOfConflicts,\n  meetingPosition,\n}: ScheduleProps & {\n  cellIndex: number;\n  cellArray: CellInfo[];\n  className?: string;\n  rangeIndex: number;\n  cell: CellInfo;\n  numberOfConflicts: number;\n  meetingPosition: number;\n}) {\n  const ref = useRef(null);\n  const [modifiedCell, setModifiedCell] = useState(cell);\n  const originalRect = useMemo(() => grid.getRectFromCell(cell), [cell, grid]);\n  const rect = useMemo(() => grid.getRectFromCell(modifiedCell), [\n    modifiedCell,\n    grid,\n  ]);\n\n  useEffect(() => {\n    setModifiedCell(cell);\n  }, [cell]);\n\n  const modifiedDateRange = useMemo(() => cellInfoToDateRange(modifiedCell), [\n    cellInfoToDateRange,\n    modifiedCell,\n  ]);\n\n  let { top, left, width, height } = rect;\n  width = width / numberOfConflicts;\n\n  const isStart = cellIndex === 0;\n  const isEnd = cellIndex === cellArray.length - 1;\n\n  const handleStop = useCallback(() => {\n    if (!onChange || disabled) {\n      return;\n    }\n\n    onChange(cellInfoToDateRange(modifiedCell), rangeIndex);\n  }, [modifiedCell, rangeIndex, disabled, cellInfoToDateRange, onChange]);\n\n  const isActive = useMemo(() => getIsActive({ cellIndex, rangeIndex }), [\n    cellIndex,\n    rangeIndex,\n    getIsActive,\n  ]);\n\n  useMousetrap(\n    'up',\n    () => {\n      if (!onChange || disabled || !isActive) {\n        return;\n      }\n\n      if (moveAxis === 'none' || moveAxis === 'x') {\n        return;\n      }\n\n      if (modifiedCell.startY === 0) {\n        return;\n      }\n\n      const newCell = {\n        ...modifiedCell,\n        startY: modifiedCell.startY - 1,\n        endY: modifiedCell.endY - 1,\n      };\n\n      onChange(cellInfoToDateRange(newCell), rangeIndex);\n    },\n    ref,\n  );\n\n  useMousetrap(\n    'shift+up',\n    () => {\n      if (!onChange || !isResizable || disabled || !isActive) {\n        return;\n      }\n\n      if (\n        modifiedCell.endY === modifiedCell.startY ||\n        modifiedCell.spanY === 0\n      ) {\n        return;\n      }\n\n      const newCell = {\n        ...modifiedCell,\n        endY: modifiedCell.endY - 1,\n        spanY: modifiedCell.spanY - 1,\n      };\n\n      onChange(cellInfoToDateRange(newCell), rangeIndex);\n    },\n    ref,\n  );\n\n  useMousetrap(\n    'down',\n    () => {\n      if (!onChange || disabled || !isActive) {\n        return;\n      }\n\n      if (moveAxis === 'none' || moveAxis === 'x') {\n        return;\n      }\n\n      if (Math.round(modifiedCell.endY) >= grid.numVerticalCells - 1) {\n        return;\n      }\n\n      const newCell = {\n        ...modifiedCell,\n        startY: modifiedCell.startY + 1,\n        endY: modifiedCell.endY + 1,\n      };\n\n      onChange(cellInfoToDateRange(newCell), rangeIndex);\n    },\n    ref,\n  );\n\n  useMousetrap(\n    'shift+down',\n    () => {\n      if (!onChange || !isResizable || disabled || !isActive) {\n        return;\n      }\n\n      if (moveAxis === 'none' || moveAxis === 'x') {\n        return;\n      }\n\n      if (Math.round(modifiedCell.endY) >= grid.numVerticalCells - 1) {\n        return;\n      }\n\n      const newCell = {\n        ...modifiedCell,\n        spanY: modifiedCell.spanY + 1,\n        endY: modifiedCell.endY + 1,\n      };\n\n      onChange(cellInfoToDateRange(newCell), rangeIndex);\n    },\n    ref,\n  );\n\n  const handleDrag: DraggableEventHandler = useCallback(\n    (event, { y, x }) => {\n      if (moveAxis === 'none' || disabled) {\n        return;\n      }\n\n      event.preventDefault();\n      event.stopPropagation();\n\n      const newRect = {\n        ...rect,\n      };\n\n      if (moveAxis === 'both' || moveAxis === 'y') {\n        const startOrEnd1 = y;\n        const startOrEnd2 = startOrEnd1 + rect.height;\n        const newTop = Math.min(startOrEnd1, startOrEnd2);\n        const newBottom = newTop + rect.height;\n        newRect.bottom = newBottom;\n        newRect.top = newTop;\n      }\n\n      if (moveAxis === 'both' || moveAxis === 'x') {\n        const startOrEnd1 = x;\n        const startOrEnd2 = startOrEnd1 + rect.width;\n        const newLeft = Math.min(startOrEnd1, startOrEnd2);\n        const newRight = newLeft + rect.width;\n        newRect.right = newRight;\n        newRect.left = newLeft;\n      }\n\n      const { startY, startX } = grid.getCellFromRect(newRect);\n\n      const newCell = {\n        ...cell,\n        startX: moveAxis === 'y' ? cell.startX : startX,\n        endX: moveAxis === 'x' ? startX + cell.spanX - 1 : cell.endX,\n        startY: moveAxis === 'x' ? cell.startY : startY,\n        endY: moveAxis === 'y' ? startY + cell.spanY - 1 : cell.endY,\n      };\n\n      invariant(\n        newCell.spanY === cell.spanY && newCell.spanX === cell.spanX,\n        `Expected the dragged time cell to have the same dimensions`,\n      );\n\n      setModifiedCell(newCell);\n    },\n    [grid, rect, moveAxis, disabled, cell, setModifiedCell],\n  );\n\n  const handleResize: ResizeCallback = useCallback(\n    (event, direction, _ref, delta) => {\n      if (!isResizable || disabled) {\n        return;\n      }\n\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (delta.height === 0) {\n        return;\n      }\n\n      const newSize = {\n        height: delta.height + rect.height,\n        width: delta.width + rect.width + 20,\n      };\n\n      const newRect = {\n        ...originalRect,\n        ...newSize,\n      };\n\n      if (direction.includes('top')) {\n        newRect.top -= delta.height;\n      } else if (direction.includes('bottom')) {\n        newRect.bottom += delta.height;\n      }\n\n      const { spanY, startY, endY } = grid.getCellFromRect(newRect);\n      const newCell = {\n        ...cell,\n        spanY,\n        startY,\n        endY,\n      };\n\n      setModifiedCell(newCell);\n    },\n    [grid, rect, disabled, isResizable, setModifiedCell, cell, originalRect],\n  );\n\n  const handleDelete = useCallback(() => {\n    if (!onChange || disabled) {\n      return;\n    }\n\n    onChange(undefined, rangeIndex);\n  }, [onChange, disabled, rangeIndex]);\n\n  const handleOnFocus = useCallback(() => {\n    if (!onActiveChange || disabled) {\n      return;\n    }\n\n    onActiveChange([rangeIndex, cellIndex]);\n  }, [onActiveChange, disabled, rangeIndex, cellIndex]);\n\n  const handleOnClick = useCallback(() => {\n    if (!onClick || disabled || !isActive) {\n      return;\n    }\n\n    onClick([rangeIndex, cellIndex]);\n  }, [onClick, rangeIndex, disabled, isActive, cellIndex]);\n\n  useMousetrap('enter', handleOnClick, ref);\n\n  const cancelClasses = useMemo(\n    () =>\n      classes.handle\n        ? classes.handle\n            .split(' ')\n            .map(className => `.${className}`)\n            .join(', ')\n        : undefined,\n    [classes.handle],\n  );\n\n  return (\n    <Draggable\n      axis={moveAxis}\n      bounds={{\n        top: 0,\n        bottom: grid.totalHeight - height,\n        left: 0,\n        right: grid.totalWidth / numberOfConflicts,\n      }}\n      position={{ x: left, y: top }}\n      onDrag={handleDrag}\n      onStop={handleStop}\n      cancel={cancelClasses}\n      disabled={disabled}\n    >\n      <EventRootComponent\n        role=\"button\"\n        disabled={disabled}\n        onFocus={handleOnFocus}\n        onClick={handleOnClick}\n        handleDelete={handleDelete}\n        cellIndex={cellIndex}\n        rangeIndex={rangeIndex}\n        isActive={isActive}\n        classes={classes}\n        className={classcat([\n          classes.event,\n          classes['range-boxes'],\n          className,\n          {\n            [classes['is-draggable']]: !disabled && moveAxis !== 'none',\n            [classes['is-disabled']]: disabled,\n          },\n        ])}\n        ref={ref}\n        style={{\n          width: width - 4,\n          height: height - 4,\n          marginLeft:\n            numberOfConflicts === 1\n              ? '2px'\n              : `${width * meetingPosition - width + 2}px`,\n          marginTop: '2px',\n        }}\n      >\n        <Resizable\n          size={{\n            ...originalRect,\n            width: originalRect.width / numberOfConflicts - 4,\n          }}\n          key={`${rangeIndex}.${cellIndex}.${cellArray.length}.${originalRect.top}.${originalRect.left}`}\n          onResize={handleResize}\n          onResizeStop={handleStop}\n          handleWrapperClass={classes['handle-wrapper']}\n          enable={\n            isResizable && !disabled\n              ? {\n                  top: true,\n                  bottom: true,\n                }\n              : {}\n          }\n          handleClasses={{\n            bottom: classcat([classes.handle, classes.bottom]),\n            bottomLeft: classes.handle,\n            bottomRight: classes.handle,\n            left: classes.handle,\n            right: classes.handle,\n            top: classcat([classes.handle, classes.top]),\n            topLeft: classes.handle,\n            topRight: classes.handle,\n          }}\n        >\n          <EventContentComponent\n            width={width}\n            height={height}\n            classes={classes}\n            dateRange={modifiedDateRange}\n            isStart={isStart}\n            isEnd={isEnd}\n            title={cell.title}\n            numberOfConflicts={numberOfConflicts}\n          />\n        </Resizable>\n      </EventRootComponent>\n    </Draggable>\n  );\n});\n","import classcat from 'classcat';\nimport { isBefore } from 'date-fns';\nimport React from 'react';\nimport {\n  CellInfo,\n  ClassNames,\n  DateRange,\n  Grid,\n  OnChangeCallback,\n  ScheduleType,\n} from '../types';\nimport { RangeBox } from './RangeBox';\n\nexport type ScheduleProps = {\n  classes: ClassNames;\n  grid: Grid;\n  onChange?: OnChangeCallback;\n  isResizable?: boolean;\n  isDeletable?: boolean;\n  moveAxis: 'none' | 'both' | 'x' | 'y';\n  cellInfoToDateRange(cell: CellInfo): DateRange;\n  onActiveChange?(index: [number, number] | [null, null]): void;\n  onClick?(index: [number, number] | [null, null]): void;\n  getIsActive(indexes: { cellIndex: number; rangeIndex: number }): boolean;\n  eventContentComponent?: any;\n  eventRootComponent?: any;\n  disabled?: boolean;\n};\n\nexport const Schedule = React.memo(function Schedule({\n  classes,\n  ranges,\n  grid,\n  className,\n  onChange,\n  isResizable,\n  isDeletable,\n  moveAxis,\n  cellInfoToDateRange,\n  dateRangeToCells,\n  onActiveChange,\n  eventContentComponent,\n  eventRootComponent,\n  onClick,\n  getIsActive,\n}: {\n  dateRangeToCells(range: DateRange): CellInfo[];\n  ranges: ScheduleType;\n  className?: string;\n  classes: ClassNames;\n} & ScheduleProps) {\n  const overlappingMeetings: { [x: number]: string }[] = [];\n\n  ranges.map((currentMeeting, currentMeetingIndex) => {\n    ranges.map((otherMeeting, otherMeetingIndex) => {\n      const sameIndex = currentMeetingIndex === otherMeetingIndex;\n      const timeRangeOverlaps =\n        currentMeeting[0] < otherMeeting[1] &&\n        currentMeeting[1] > otherMeeting[0];\n      if (!sameIndex && timeRangeOverlaps) {\n        overlappingMeetings.push({\n          [currentMeetingIndex]: otherMeetingIndex.toString(),\n        });\n      }\n    });\n  });\n\n  const meetingConflicts = overlappingMeetings.reduce(\n    (accum: { [x: string]: any }, obj: { [x: string]: any }) => {\n      for (let key in obj) {\n        accum[key] = accum[key] ? [...accum[key], obj[key]] : [obj[key]];\n      }\n      return accum;\n    },\n    [],\n  );\n\n  const countUnique = (iterable: Iterable<number>) => {\n    return new Set(iterable).size;\n  };\n\n  const calculateMeetingPlacement = (rangeIndex: number) => {\n    let numberOfConflicts = 1;\n    let meetingPosition = 1;\n\n    if (!meetingConflicts.hasOwnProperty(rangeIndex)) {\n      return { numberOfConflicts, meetingPosition };\n    }\n\n    meetingConflicts[rangeIndex].map((currentMeeting: number) => {\n      if (\n        currentMeeting !== rangeIndex &&\n        meetingConflicts[rangeIndex].length > 1\n      ) {\n        let totalConflicts: number[] = [];\n        let positionArray: boolean[] = [];\n\n        meetingConflicts[rangeIndex].map((range: number) => {\n          positionArray.push(rangeIndex > range);\n          meetingConflicts[rangeIndex].map((currentConflict: number) => {\n            totalConflicts.push(...meetingConflicts[currentConflict]);\n          });\n\n          numberOfConflicts =\n            countUnique(\n              totalConflicts.filter(index => index !== currentMeeting),\n            ) + 1;\n        });\n        meetingPosition = positionArray.filter(c => c === true).length + 1;\n      } else {\n        numberOfConflicts = 2;\n        const numberOfExistingOverlaps = meetingConflicts[rangeIndex][0];\n\n        if (meetingConflicts[numberOfExistingOverlaps].length > 2) {\n          meetingPosition =\n            meetingConflicts[numberOfExistingOverlaps].length + 1;\n        } else {\n          meetingPosition =\n            rangeIndex < Number(...meetingConflicts[rangeIndex]) ? 1 : 2;\n        }\n\n        numberOfConflicts = Math.max(\n          2,\n          meetingConflicts[numberOfExistingOverlaps].length + 1,\n        );\n      }\n    });\n\n    return { numberOfConflicts, meetingPosition };\n  };\n\n  return (\n    <div className={classes['range-boxes']}>\n      {ranges.map((dateRange, rangeIndex) => {\n        const isPast = isBefore(dateRange[1], new Date());\n        return (\n          <span key={rangeIndex}>\n            {dateRangeToCells(dateRange).map((cell, cellIndex, cellArray) => {\n              const isGoogleEvent = cell.source === 'google';\n              const {\n                numberOfConflicts,\n                meetingPosition,\n              } = calculateMeetingPlacement(rangeIndex);\n\n              return (\n                <RangeBox\n                  classes={classes}\n                  onActiveChange={onActiveChange}\n                  key={`${rangeIndex}.${ranges.length}.${cellIndex}.${cellArray.length}`}\n                  isResizable={isResizable}\n                  moveAxis={moveAxis}\n                  isDeletable={isDeletable}\n                  cellInfoToDateRange={cellInfoToDateRange}\n                  cellArray={cellArray}\n                  cellIndex={cellIndex}\n                  rangeIndex={rangeIndex}\n                  className={classcat([\n                    className,\n                    {\n                      [classes['is-past']]: isPast,\n                      [classes['is-google']]: isGoogleEvent,\n                    },\n                  ])}\n                  onChange={onChange}\n                  onClick={onClick}\n                  grid={grid}\n                  cell={cell}\n                  getIsActive={getIsActive}\n                  eventContentComponent={eventContentComponent}\n                  eventRootComponent={eventRootComponent}\n                  disabled={isGoogleEvent}\n                  numberOfConflicts={numberOfConflicts}\n                  meetingPosition={meetingPosition}\n                />\n              );\n            })}\n          </span>\n        );\n      })}\n    </div>\n  );\n});\n","import classcat from 'classcat';\nimport React, { useMemo } from 'react';\nimport Draggable from 'react-draggable';\nimport { CellInfo } from '../types';\nimport { DefaultEventRootComponent } from './DefaultEventRootComponent';\nimport { TimeIndicatorProps } from './TimeIndicator';\n\nexport const IndicatorLine = React.memo(function IndicatorLine({\n  classes,\n  grid,\n  cell,\n  eventRootComponent: EventRootComponent = DefaultEventRootComponent,\n}: TimeIndicatorProps & {\n  className?: string;\n  cell: CellInfo;\n}) {\n  const rect = useMemo(() => grid.getRectFromCell(cell), [cell, grid]);\n  const { top, left, width, height } = rect;\n\n  return (\n    <Draggable\n      bounds={{\n        top: 0,\n        bottom: grid.totalHeight - height,\n        left: 0,\n        right: grid.totalWidth,\n      }}\n      position={{ x: left, y: top }}\n      key={`draggable-${width}.${height}.${top}.${left}`}\n    >\n      <EventRootComponent\n        className={classcat([classes.indicator])}\n        style={{\n          width: width,\n          height: 2,\n        }}\n        key={`eventroot-${width}.${height}.${top}.${left}`}\n      ></EventRootComponent>\n    </Draggable>\n  );\n});\n","import classcat from 'classcat';\nimport React from 'react';\nimport { CellInfo, ClassNames, DateRange, Grid } from '../types';\nimport { IndicatorLine } from './IndicatorLine';\n\nexport type TimeIndicatorProps = {\n  classes: ClassNames;\n  grid: Grid;\n  cellInfoToDateRange(cell: CellInfo): DateRange;\n  eventRootComponent?: any;\n};\n\nexport const TimeIndicator = React.memo(function TimeIndicator({\n  classes,\n  currentTime,\n  grid,\n  className,\n  cellInfoToDateRange,\n  dateRangeToCells,\n  eventRootComponent,\n}: {\n  dateRangeToCells(range: DateRange): CellInfo[];\n  currentTime: DateRange;\n  className?: string;\n  classes: ClassNames;\n} & TimeIndicatorProps) {\n  // const [cellInfo, setCellInfo] = useState(dateRangeToCells(currentTime));\n\n  // useEffect(() => {\n  //   setCellInfo(dateRangeToCells(currentTime));\n  //   console.log(currentTime);\n  // }, [currentTime]);\n\n  return (\n    <div>\n      {dateRangeToCells(currentTime).map((cell, index) => {\n        return (\n          <IndicatorLine\n            key={`indicator-${index}`}\n            classes={classes}\n            cellInfoToDateRange={cellInfoToDateRange}\n            className={classcat([className])}\n            grid={grid}\n            cell={cell}\n            eventRootComponent={eventRootComponent}\n          />\n        );\n      })}\n    </div>\n  );\n});\n","import useComponentSize from '@rehooks/component-size';\nimport classcat from 'classcat';\nimport { isPast, isToday } from 'date-fns';\nimport addDays from 'date-fns/add_days';\nimport addHours from 'date-fns/add_hours';\nimport format from 'date-fns/format';\nimport isDateEqual from 'date-fns/is_equal';\nimport en from 'date-fns/locale/en';\nimport ja from 'date-fns/locale/ja';\nimport startOfDay from 'date-fns/start_of_day';\nimport invariant from 'invariant';\nimport isEqual from 'lodash/isEqual';\nimport times from 'lodash/times';\nimport { ExtendedKeyboardEvent } from 'mousetrap';\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport scrollIntoView from 'scroll-into-view-if-needed';\nimport { useClickAndDrag } from '../hooks/useClickAndDrag';\nimport { useMousetrap } from '../hooks/useMousetrap';\nimport {\n  CellInfo,\n  ClassNames,\n  DateRange,\n  Grid,\n  OnChangeCallback,\n  ScheduleType,\n} from '../types';\nimport { createGrid } from '../utils/createGrid';\nimport {\n  createMapCellInfoToRecurringTimeRange,\n  RecurringTimeRange,\n} from '../utils/createMapCellInfoToRecurringTimeRange';\nimport { createMapDateRangeToCells } from '../utils/createMapDateRangeToCells';\nimport { getEarliestTimeRange } from '../utils/getEarliestTimeRange';\nimport { getSpan } from '../utils/getSpan';\nimport { Cell } from './Cell';\nimport { Schedule, ScheduleProps } from './Schedule';\nimport { TimeIndicator } from './TimeIndicator';\n\nconst MINS_IN_DAY = 24 * 60;\nconst horizontalPrecision = 1;\nconst toDay = (x: number): number => x * horizontalPrecision;\nconst toX = (days: number): number => days / horizontalPrecision;\nconst DELETE_KEYS = ['del', 'backspace'];\n\nexport const TimeGridScheduler = React.memo(function TimeGridScheduler({\n  verticalPrecision = 15,\n  visualGridVerticalPrecision = 30,\n  cellClickPrecision = visualGridVerticalPrecision,\n  style,\n  schedule,\n  originDate: _originDate = new Date(),\n  defaultHours = [9, 18],\n  classes,\n  className,\n  onChange,\n  onEventClick,\n  eventContentComponent,\n  eventRootComponent,\n  disabled,\n  localization,\n  isMobile,\n  currentTime,\n}: {\n  originDate?: Date;\n\n  /**\n   * The minimum number of minutes a created range can span\n   * @default 15\n   */\n  verticalPrecision?: number;\n\n  /**\n   * The visual grid increments in minutes.\n   * @default 30\n   */\n  visualGridVerticalPrecision?: number;\n\n  /**\n   * The minimum number of minutes for an time block\n   * created with a single click.\n   * @default visualGridVerticalPrecision\n   */\n  cellClickPrecision?: number;\n\n  /** Custom styles applied to the root of the view */\n  style?: React.CSSProperties;\n  schedule: ScheduleType;\n\n  /**\n   * A map of class names to the scoped class names\n   * The keys are class names like `'root'` and the values\n   * are the corresponding class names which can be scoped\n   * with CSS Modules, e.g. `'_root_7f2c6'`.\n   */\n  classes: ClassNames;\n  className?: string;\n\n  /**\n   * The view will initially be scrolled to these hours.\n   * Defaults to work hours (9-17).\n   * @default [9, 17]\n   */\n  defaultHours?: [number, number];\n\n  onChange(newSchedule: ScheduleType): void;\n  onEventClick?: ScheduleProps['onClick'];\n  eventContentComponent?: ScheduleProps['eventContentComponent'];\n  eventRootComponent?: ScheduleProps['eventRootComponent'];\n  disabled?: boolean;\n  localization: string;\n  isMobile: boolean;\n  currentTime: [string, string, string, string];\n}) {\n  const locale = localization === 'ja' ? ja : en;\n  const numberOfDays = isMobile ? 1 : 7;\n  const originDate = useMemo(() => startOfDay(_originDate), [_originDate]);\n  const numVerticalCells = MINS_IN_DAY / verticalPrecision;\n  const numHorizontalCells = numberOfDays / horizontalPrecision;\n  const toMin = useCallback((y: number) => y * verticalPrecision, [\n    verticalPrecision,\n  ]);\n  const toY = useCallback((mins: number): number => mins / verticalPrecision, [\n    verticalPrecision,\n  ]);\n\n  const cellInfoToDateRanges = useMemo(() => {\n    return createMapCellInfoToRecurringTimeRange({\n      originDate,\n      fromY: toMin,\n      fromX: toDay,\n    });\n  }, [toMin, originDate]);\n\n  const cellInfoToSingleDateRange = useCallback(\n    (cell: CellInfo): DateRange => {\n      const [first, ...rest] = cellInfoToDateRanges(cell);\n      invariant(\n        rest.length === 0,\n        `Expected \"cellInfoToSingleDateRange\" to return a single date range, found ${rest.length}\n        additional ranges instead. This is a bug in @remotelock/react-week-scheduler`,\n      );\n\n      return first;\n    },\n    [cellInfoToDateRanges],\n  );\n\n  const dateRangeToCells = useMemo(() => {\n    return createMapDateRangeToCells({\n      originDate,\n      numVerticalCells,\n      numHorizontalCells,\n      toX,\n      toY,\n    });\n  }, [toY, numVerticalCells, numHorizontalCells, originDate]);\n\n  const root = useRef<HTMLDivElement | null>(null);\n  const parent = useRef<HTMLDivElement | null>(null);\n\n  const size = useComponentSize(parent);\n  const {\n    style: dragBoxStyle,\n    box,\n    isDragging,\n    hasFinishedDragging,\n    cancel,\n  } = useClickAndDrag(parent, disabled);\n  const [\n    pendingCreation,\n    setPendingCreation,\n  ] = useState<RecurringTimeRange | null>(null);\n\n  const [[totalHeight, totalWidth], setDimensions] = useState([0, 0]);\n\n  const numVisualVerticalCells = (24 * 60) / visualGridVerticalPrecision;\n\n  useEffect(\n    function updateGridDimensionsOnSizeOrCellCountChange() {\n      if (!parent.current) {\n        setDimensions([0, 0]);\n        return;\n      }\n\n      setDimensions([parent.current.scrollHeight, parent.current.scrollWidth]);\n    },\n    [size, numVisualVerticalCells],\n  );\n\n  const grid = useMemo<Grid | null>(() => {\n    if (totalHeight === null || totalWidth === null) {\n      return null;\n    }\n\n    return createGrid({\n      totalHeight,\n      totalWidth,\n      numHorizontalCells,\n      numVerticalCells,\n    });\n  }, [totalHeight, totalWidth, numHorizontalCells, numVerticalCells]);\n\n  useEffect(\n    function updatePendingCreationOnDragBoxUpdate() {\n      if (grid === null || box === null) {\n        setPendingCreation(null);\n        return;\n      }\n\n      const cell = grid.getCellFromRect(box);\n      const dateRanges = cellInfoToDateRanges(cell);\n      const event = dateRanges;\n      setPendingCreation(event);\n    },\n    [box, grid, cellInfoToDateRanges, toY],\n  );\n\n  const [[activeRangeIndex, activeCellIndex], setActive] = useState<\n    [number, number] | [null, null]\n  >([null, null]);\n\n  useEffect(\n    function updateScheduleAfterDraggingFinished() {\n      if (disabled) {\n        return;\n      }\n\n      if (hasFinishedDragging) {\n        if (pendingCreation) {\n          onChange([...schedule, ...pendingCreation]);\n        }\n        setPendingCreation(null);\n      }\n    },\n    [\n      hasFinishedDragging,\n      disabled,\n      onChange,\n      setPendingCreation,\n      pendingCreation,\n      schedule,\n    ],\n  );\n\n  useEffect(\n    function clearActiveBlockAfterCreation() {\n      if (pendingCreation === null) {\n        setActive([null, null]);\n      }\n    },\n    [pendingCreation],\n  );\n\n  const handleEventChange = useCallback<OnChangeCallback>(\n    (newDateRange, rangeIndex) => {\n      if (disabled) {\n        return;\n      }\n\n      if (!schedule && newDateRange) {\n        onChange([newDateRange]);\n\n        return;\n      }\n\n      let newSchedule = [...schedule];\n\n      if (!newDateRange) {\n        newSchedule.splice(rangeIndex, 1);\n      } else {\n        if (\n          isDateEqual(newDateRange[0], newSchedule[rangeIndex][0]) &&\n          isDateEqual(newDateRange[1], newSchedule[rangeIndex][1])\n        ) {\n          return;\n        }\n        newSchedule[rangeIndex] = newDateRange;\n      }\n\n      onChange(newSchedule);\n    },\n    [schedule, onChange, disabled],\n  );\n\n  useMousetrap(\n    'esc',\n    function cancelOnEsc() {\n      if (pendingCreation) {\n        cancel();\n      }\n    },\n    document,\n  );\n\n  const getIsActive = useCallback(\n    ({ rangeIndex, cellIndex }) => {\n      return rangeIndex === activeRangeIndex && cellIndex === activeCellIndex;\n    },\n    [activeCellIndex, activeRangeIndex],\n  );\n\n  const handleDelete = useCallback(\n    (e: ExtendedKeyboardEvent) => {\n      if (activeRangeIndex === null || disabled) {\n        return;\n      }\n\n      e.preventDefault();\n      e.stopPropagation();\n      handleEventChange(undefined, activeRangeIndex);\n    },\n    [activeRangeIndex, disabled, handleEventChange],\n  );\n\n  useMousetrap(DELETE_KEYS, handleDelete, root);\n\n  useEffect(\n    function cancelPendingCreationOnSizeChange() {\n      cancel();\n    },\n    [size, cancel],\n  );\n\n  const getDateRangeForVisualGrid = useMemo(() => {\n    return createMapCellInfoToRecurringTimeRange({\n      originDate,\n      fromX: toDay,\n      fromY: y => y * visualGridVerticalPrecision,\n      // source,\n      // title,\n    });\n  }, [visualGridVerticalPrecision, originDate]);\n\n  useEffect(\n    function scrollToActiveTimeBlock() {\n      if (!document.activeElement) {\n        return;\n      }\n\n      if (!root.current || !root.current.contains(document.activeElement)) {\n        return;\n      }\n\n      scrollIntoView(document.activeElement, {\n        scrollMode: 'if-needed',\n        block: 'nearest',\n        inline: 'nearest',\n      });\n    },\n    [schedule],\n  );\n\n  const [wasInitialScrollPerformed, setWasInitialScrollPerformed] = useState(\n    false,\n  );\n\n  useEffect(\n    function performInitialScroll() {\n      if (wasInitialScrollPerformed || !root.current || !grid) {\n        return;\n      }\n\n      const range = dateRangeToCells(\n        getEarliestTimeRange(schedule) || [\n          addHours(originDate, defaultHours[0]),\n          addHours(originDate, defaultHours[1]),\n          '',\n          '',\n        ],\n      );\n      const rect = grid.getRectFromCell(range[0]);\n      const { top, bottom } = rect;\n\n      if (top === 0 && bottom === 0) {\n        return;\n      }\n\n      // IE, Edge do not support it\n      if (!('scrollBy' in root.current)) {\n        return;\n      }\n\n      root.current.scrollBy(0, top);\n\n      setWasInitialScrollPerformed(true);\n    },\n    [\n      wasInitialScrollPerformed,\n      grid,\n      schedule,\n      defaultHours,\n      originDate,\n      dateRangeToCells,\n    ],\n  );\n\n  const handleBlur: React.FocusEventHandler = useCallback(\n    event => {\n      if (!event.target.contains(document.activeElement)) {\n        setActive([null, null]);\n      }\n    },\n    [setActive],\n  );\n\n  const handleCellClick = useCallback(\n    (dayIndex: number, timeIndex: number) => (event: React.MouseEvent) => {\n      if (!grid || disabled) {\n        return;\n      }\n\n      const spanY = toY(cellClickPrecision);\n      const cell = {\n        startX: dayIndex,\n        startY: timeIndex,\n        endX: dayIndex,\n        endY: spanY + timeIndex,\n        spanY,\n        spanX: getSpan(dayIndex, dayIndex),\n        source: '',\n        title: '',\n      };\n\n      const dateRanges = cellInfoToDateRanges(cell);\n\n      setPendingCreation(dateRanges);\n\n      event.stopPropagation();\n      event.preventDefault();\n    },\n    [grid, disabled, toY, cellClickPrecision, cellInfoToDateRanges],\n  );\n\n  return (\n    <div\n      ref={root}\n      style={style}\n      onBlur={handleBlur}\n      touch-action={isDragging ? 'none' : undefined}\n      className={classcat([\n        classes.root,\n        classes.theme,\n        className,\n        { [classes['no-scroll']]: isDragging },\n      ])}\n    >\n      <div className={classes['grid-root']}>\n        <div\n          aria-hidden\n          className={classcat([classes.timeline, classes['sticky-left']])}\n        >\n          <div className={classes.header}>\n            <div className={classes['day-column']}>\n              <div className={classcat([classes.cell, classes.title])}>T</div>\n            </div>\n          </div>\n          <div className={classes.calendar}>\n            <div className={classes['day-column']}>\n              <div className={classes['day-hours']}>\n                {times(numVisualVerticalCells).map(timeIndex => {\n                  return (\n                    <Cell\n                      classes={classes}\n                      getDateRangeForVisualGrid={getDateRangeForVisualGrid}\n                      key={timeIndex}\n                      timeIndex={timeIndex}\n                    >\n                      {({ start, isHourStart }) => {\n                        if (isHourStart) {\n                          return (\n                            <div className={classes.time}>\n                              {format(start, 'hh:mm', { locale })}\n                            </div>\n                          );\n                        }\n\n                        return null;\n                      }}\n                    </Cell>\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        </div>\n        <div\n          className={classcat([\n            classes['sticky-top'],\n            classes['day-header-row'],\n          ])}\n        >\n          <div\n            role=\"presentation\"\n            className={classcat([classes.calendar, classes.header])}\n          >\n            {times(numberOfDays).map(i => (\n              <div\n                key={i}\n                role=\"presentation\"\n                className={classes['day-column']}\n              >\n                <div\n                  className={classcat([\n                    classes.cell,\n                    classes.title,\n                    { [classes['is-past']]: isPast(addDays(originDate, i)) },\n                    {\n                      [classes['is-current']]: isToday(addDays(originDate, i)),\n                    },\n                  ])}\n                >\n                  <span>\n                    {format(addDays(originDate, i), 'ddd ', { locale })}\n                  </span>\n                  <span>\n                    {format(addDays(originDate, i), 'MMM ', { locale })}\n                  </span>\n                  <span className={classes.date}>\n                    {format(addDays(originDate, i), 'D', { locale })}\n                  </span>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n        <div className={classes['layer-container']}>\n          {isDragging && (\n            <div className={classes['drag-box']} style={dragBoxStyle}>\n              {hasFinishedDragging && <div className={classes.popup} />}\n            </div>\n          )}\n          {grid && pendingCreation && isDragging && (\n            <Schedule\n              classes={classes}\n              dateRangeToCells={dateRangeToCells}\n              cellInfoToDateRange={cellInfoToSingleDateRange}\n              className={classes['is-pending-creation']}\n              ranges={[...schedule, ...pendingCreation]}\n              grid={grid}\n              moveAxis=\"none\"\n              eventContentComponent={eventContentComponent}\n              getIsActive={getIsActive}\n            />\n          )}\n          {grid && !pendingCreation && (\n            <Schedule\n              classes={classes}\n              onActiveChange={setActive}\n              dateRangeToCells={dateRangeToCells}\n              cellInfoToDateRange={cellInfoToSingleDateRange}\n              isResizable\n              moveAxis=\"y\"\n              isDeletable\n              onChange={handleEventChange}\n              onClick={onEventClick}\n              ranges={schedule}\n              grid={grid}\n              eventContentComponent={eventContentComponent}\n              eventRootComponent={eventRootComponent}\n              getIsActive={getIsActive}\n              disabled={disabled}\n            />\n          )}\n          {grid && (\n            <TimeIndicator\n              key={`test-time-${currentTime}`}\n              classes={classes}\n              dateRangeToCells={dateRangeToCells}\n              cellInfoToDateRange={cellInfoToSingleDateRange}\n              currentTime={\n                (currentTime as unknown) as [Date, Date, string, string]\n              }\n              grid={grid}\n            />\n          )}\n\n          <div ref={parent} role=\"grid\" className={classes.calendar}>\n            {times(numberOfDays).map(dayIndex => {\n              const isPassed = isPast(addDays(originDate, dayIndex + 1));\n              return (\n                <div\n                  role=\"gridcell\"\n                  key={dayIndex}\n                  className={classes['day-column']}\n                >\n                  <div\n                    className={classcat([\n                      classes['day-hours'],\n                      {\n                        [classes['is-past']]: isPassed,\n                      },\n                    ])}\n                  >\n                    {times(numVisualVerticalCells).map(timeIndex => {\n                      return (\n                        <Cell\n                          classes={classes}\n                          onClick={\n                            !isPassed\n                              ? handleCellClick(\n                                  dayIndex,\n                                  timeIndex *\n                                    (numVerticalCells / numVisualVerticalCells),\n                                )\n                              : undefined\n                          }\n                          getDateRangeForVisualGrid={getDateRangeForVisualGrid}\n                          key={timeIndex}\n                          timeIndex={timeIndex}\n                        />\n                      );\n                    })}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}, isEqual);\n"],"names":["DefaultEventRootComponent","React","memo","forwardRef","ref","isActive","handleDelete","cellIndex","rangeIndex","classes","disabled","props","displayName","createPageMapCoordsToContainer","container","event","clientX","clientY","pageX","pageY","changedTouches","getBoundingClientRect","top","left","x","y","prevent","tap","e","preventDefault","stopPropagation","useClickAndDrag","isDisabled","useState","transform","width","height","style","setStyle","box","setBox","isDragging","setIsDragging","hasFinishedDragging","setHasFinishedDragging","current","useEffect","mapCoordsToContainer","touchMove$","fromEvent","window","passive","pipe","touchEnd$","touchStart$","touchStartWithDelay$","mergeMap","start","of","delay","takeUntil","mouseDown$","filter","which","mouseMove$","mouseUp$","dragStart$","merge","map","dragEnd$","move$","box$","down","startWith","move","startX","Math","max","startY","endX","min","scrollWidth","endY","scrollHeight","bottom","right","source","title","rect","style$","display","boxSubscriber","subscribe","styleSubscriber","unsubscribe","cancel","useCallback","useMousetrap","handlerKey","handlerCallback","elementOrElementRef","actionRef","useRef","element","document","instance","Mousetrap","bind","combo","unbind","getSpan","x1","x2","abs","createGrid","totalHeight","totalWidth","numVerticalCells","numHorizontalCells","cellHeight","cellWidth","getRectFromCell","data","spanX","spanY","getCellFromRect","clamp","floor","round","cellToDate","toMin","originDate","addMinutes","addDays","createMapCellInfoToRecurringTimeRange","fromY","toDay","fromX","result","range","i","startDate","endDate","endOfDay","isBefore","sort","range1","range2","compareAsc","createMapDateRangeToCells","toX","toY","end","originOfThisDay","startOfDay","_startX","differenceInDays","_startY","differenceInMinutes","_endX","_endY","cells","atStart","atEnd","isEqual","pop","getEarliestTimeRange","ranges","startA","startB","setDay","Cell","timeIndex","children","getDateRangeForVisualGrid","onClick","isHourStart","getMinutes","classcat","cell","SchedulerContext","createContext","locale","en","formatTemplate","dropSame","dates","template","takeSecond","date","format","first","second","formatHour","getFormattedComponentsForDateRange","dateRange","template2","includeDayIfSame","isSameDay","firstM","secondM","day","startDateStr","endDateStr","getTextForDateRange","options","join","EventContent","isStart","isEnd","numberOfConflicts","useContext","isFifteenMinuteMeeting","padding","RangeBox","grid","cellArray","className","onChange","cellInfoToDateRange","isResizable","moveAxis","onActiveChange","getIsActive","eventContentComponent","EventContentComponent","eventRootComponent","EventRootComponent","meetingPosition","modifiedCell","setModifiedCell","originalRect","useMemo","modifiedDateRange","length","handleStop","newCell","handleDrag","newRect","startOrEnd1","startOrEnd2","newTop","newBottom","newLeft","newRight","invariant","handleResize","direction","_ref","delta","newSize","includes","undefined","handleOnFocus","handleOnClick","cancelClasses","handle","split","marginLeft","marginTop","bottomLeft","bottomRight","topLeft","topRight","Schedule","isDeletable","dateRangeToCells","overlappingMeetings","currentMeeting","currentMeetingIndex","otherMeeting","otherMeetingIndex","sameIndex","timeRangeOverlaps","push","toString","meetingConflicts","reduce","accum","obj","key","countUnique","iterable","Set","size","calculateMeetingPlacement","hasOwnProperty","totalConflicts","positionArray","currentConflict","index","c","numberOfExistingOverlaps","Number","isPast","Date","isGoogleEvent","IndicatorLine","indicator","TimeIndicator","currentTime","MINS_IN_DAY","horizontalPrecision","days","DELETE_KEYS","TimeGridScheduler","verticalPrecision","visualGridVerticalPrecision","cellClickPrecision","schedule","_originDate","defaultHours","onEventClick","localization","isMobile","ja","numberOfDays","mins","cellInfoToDateRanges","cellInfoToSingleDateRange","rest","root","parent","useComponentSize","dragBoxStyle","pendingCreation","setPendingCreation","setDimensions","numVisualVerticalCells","updateGridDimensionsOnSizeOrCellCountChange","updatePendingCreationOnDragBoxUpdate","dateRanges","activeRangeIndex","activeCellIndex","setActive","updateScheduleAfterDraggingFinished","clearActiveBlockAfterCreation","handleEventChange","newDateRange","newSchedule","splice","isDateEqual","cancelOnEsc","cancelPendingCreationOnSizeChange","scrollToActiveTimeBlock","activeElement","contains","scrollIntoView","scrollMode","block","inline","wasInitialScrollPerformed","setWasInitialScrollPerformed","performInitialScroll","addHours","scrollBy","handleBlur","target","handleCellClick","dayIndex","theme","timeline","header","calendar","times","time","isToday","popup","isPassed"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAGaA,yBAAyB,gBAAGC,KAAK,CAACC,IAAN;AACvCD,KAAK,CAACE,UAAN,CAAsC,SAASH,yBAAT;;;;;;;;;;AAUpCI,GAVoC;AAWpC,KATEC,QASF,QATEA,QASF,CAREC,YAQF,QAREA,YAQF,CAPEC,SAOF,QAPEA,SAOF,CANEC,UAMF,QANEA,UAMF,CALEC,OAKF,QALEA,OAKF,CAJEC,QAIF,QAJEA,QAIF,CAHKC,KAGL;AACA,sBAAO,sCAAK,GAAG,EAAEP,GAAV,EAAe,iBAAeM,QAA9B,IAA4CC,KAA5C,EAAP;AACD,CAbD,CADuC;;;AAiBzCX,yBAAyB,CAACY,WAA1B,GAAwC,2BAAxC;;ACpBO,IAAMC,8BAA8B,GAAG,SAAjCA,8BAAiC,CAACC,SAAD,EAA4B;AACxE,SAAO,UAACC,KAAD,EAAuD;AAC5D,QAAIC,OAAJ;AACA,QAAIC,OAAJ;AACA,QAAIC,KAAJ;AACA,QAAIC,KAAJ;;AAEA,QAAI,oBAAoBJ,KAAxB,EAA+B;AACSA,MAAAA,KAAK,CAACK,cAAN,CAAqB,CAArB,CADT,CAC1BJ,OAD0B,yBAC1BA,OAD0B,CACjBC,OADiB,yBACjBA,OADiB,CACRC,KADQ,yBACRA,KADQ,CACDC,KADC,yBACDA,KADC;AAE9B,KAFD,MAEO;AACFH,MAAAA,OADE,GACiCD,KADjC,CACFC,OADE,CACOC,OADP,GACiCF,KADjC,CACOE,OADP,CACgBC,KADhB,GACiCH,KADjC,CACgBG,KADhB,CACuBC,KADvB,GACiCJ,KADjC,CACuBI,KADvB;AAEN,KAV2D;AAWtCL,IAAAA,SAAS,CAACO,qBAAV,EAXsC,CAWpDC,GAXoD,yBAWpDA,GAXoD,CAW/CC,IAX+C,yBAW/CA,IAX+C;;AAa5D,WAAO;AACLP,MAAAA,OAAO,EAAPA,OADK;AAELC,MAAAA,OAAO,EAAPA,OAFK;AAGLC,MAAAA,KAAK,EAALA,KAHK;AAILC,MAAAA,KAAK,EAALA,KAJK;AAKLG,MAAAA,GAAG,EAAHA,GALK;AAMLC,MAAAA,IAAI,EAAJA,IANK;AAOLC,MAAAA,CAAC,EAAER,OAAO,GAAGO,IAPR;AAQLE,MAAAA,CAAC,EAAER,OAAO,GAAGK,GARR,EAAP;;AAUD,GAvBD;AAwBD,CAzBM;;ACcP,IAAMI,OAAO,gBAAGC,GAAG,CAAC,UAACC,CAAD,EAAmB;AACrCA,EAAAA,CAAC,CAACC,cAAF;AACAD,EAAAA,CAAC,CAACE,eAAF;AACD,CAHkB,CAAnB;;AAKA,AAAO,SAASC,eAAT;AACL3B,GADK;AAEL4B,UAFK;AAGL;AAC0BC,EAAAA,QAAQ,CAAsB;AACtDC,IAAAA,SAAS,EAAE,iBAD2C;AAEtDC,IAAAA,KAAK,EAAE,CAF+C;AAGtDC,IAAAA,MAAM,EAAE,CAH8C,EAAtB,CADlC,2CACOC,KADP,iBACcC,QADd;;AAMsBL,EAAAA,QAAQ,CAAc,IAAd,CAN9B,4CAMOM,GANP,iBAMYC,MANZ;AAOoCP,EAAAA,QAAQ,CAAC,KAAD,CAP5C,4CAOOQ,UAPP,iBAOmBC,aAPnB;AAQsDT,EAAAA,QAAQ,CAAC,KAAD,CAR9D,4CAQOU,mBARP,iBAQ4BC,sBAR5B;AASA,MAAM9B,SAAS,GAAGV,GAAG,CAACyC,OAAtB;;AAEAC,EAAAA,SAAS,CAAC,YAAM;AACd,QAAI,CAAChC,SAAD,IAAckB,UAAlB,EAA8B;AAC5B;AACD;;AAED,QAAMe,oBAAoB,GAAGlC,8BAA8B,CAACC,SAAD,CAA3D;;AAEA,QAAMkC,UAAU,GAAGC,SAAS,CAAaC,MAAb,EAAqB,WAArB,EAAkC;AAC5DC,MAAAA,OAAO,EAAE,KADmD,EAAlC,CAAT;AAEhBC,IAAAA,IAFgB,CAEX1B,OAFW,CAAnB;;AAIA,QAAM2B,SAAS,GAAGJ,SAAS,CAAaC,MAAb,EAAqB,UAArB,EAAiC;AAC1DC,MAAAA,OAAO,EAAE,IADiD,EAAjC,CAA3B;;;AAIA,QAAMG,WAAW,GAAGL,SAAS,CAAanC,SAAb,EAAwB,YAAxB,EAAsC;AACjEqC,MAAAA,OAAO,EAAE,KADwD,EAAtC,CAA7B;;;AAIA,QAAMI,oBAAoB,GAAGD,WAAW,CAACF,IAAZ;AAC3BI,IAAAA,QAAQ,CAAC,UAAAC,KAAK;AACZC,QAAAA,EAAE,CAACD,KAAD,CAAF,CAAUL,IAAV,CAAeO,KAAK,CAAC,GAAD,CAApB,EAA2BC,SAAS,CAACZ,UAAD,CAApC,EAAkDtB,OAAlD,CADY,GAAN,CADmB,CAA7B;;;;AAMA,QAAMmC,UAAU,GAAGZ,SAAS,CAAanC,SAAb,EAAwB,WAAxB,EAAqC;AAC/DqC,MAAAA,OAAO,EAAE,IADsD,EAArC,CAAT;AAEhBC,IAAAA,IAFgB,CAEXU,MAAM,CAAC,UAAA/C,KAAK,UAAIA,KAAK,CAACgD,KAAN,KAAgB,CAApB,EAAN,CAFK,CAAnB;;AAIA,QAAMC,UAAU,GAAGf,SAAS,CAAaC,MAAb,EAAqB,WAArB,EAAkC;AAC5DC,MAAAA,OAAO,EAAE,IADmD,EAAlC,CAA5B;;;AAIA,QAAMc,QAAQ,GAAGhB,SAAS,CAAaC,MAAb,EAAqB,SAArB,EAAgC;AACxDC,MAAAA,OAAO,EAAE,IAD+C,EAAhC,CAA1B;;;AAIA,QAAMe,UAAU,GAAGC,KAAK,CAACN,UAAD,EAAaN,oBAAb,CAAL,CAAwCH,IAAxC;AACjBgB,IAAAA,GAAG,CAACrB,oBAAD,CADc,CAAnB;;;AAIA,QAAMsB,QAAQ,GAAGF,KAAK,CAACF,QAAD,EAAWZ,SAAX,CAAL,CAA2BD,IAA3B;AACfgB,IAAAA,GAAG,CAACrB,oBAAD,CADY;AAEfpB,IAAAA,GAAG,CAAC,YAAM;AACRe,MAAAA,aAAa,CAAC,KAAD,CAAb;AACAE,MAAAA,sBAAsB,CAAC,IAAD,CAAtB;AACD,KAHE,CAFY,CAAjB;;;AAQA,QAAM0B,KAAK,GAAGH,KAAK,CAACH,UAAD,EAAahB,UAAb,CAAL,CAA8BI,IAA9B,CAAmCgB,GAAG,CAACrB,oBAAD,CAAtC,CAAd;;AAEA,QAAMwB,IAA6B,GAAGL,UAAU,CAACd,IAAX;AACpCzB,IAAAA,GAAG,CAAC,YAAM;AACRe,MAAAA,aAAa,CAAC,IAAD,CAAb;AACAE,MAAAA,sBAAsB,CAAC,KAAD,CAAtB;AACD,KAHE,CADiC;AAKpCY,IAAAA,QAAQ,CAAC,UAAAgB,IAAI,EAAI;AACf,aAAOF,KAAK,CAAClB,IAAN;AACLqB,MAAAA,SAAS,CAACD,IAAD,CADJ;AAELJ,MAAAA,GAAG;AACD,gBAACM,IAAD,EAAgB;AACd,YAAMC,MAAM,GAAGC,IAAI,CAACC,GAAL,CAASL,IAAI,CAAChD,CAAd,EAAiB,CAAjB,CAAf;AACA,YAAMsD,MAAM,GAAGF,IAAI,CAACC,GAAL,CAASL,IAAI,CAAC/C,CAAd,EAAiB,CAAjB,CAAf;AACA,YAAMsD,IAAI,GAAGH,IAAI,CAACI,GAAL,CAASN,IAAI,CAAClD,CAAd,EAAiBV,SAAS,CAACmE,WAA3B,CAAb;AACA,YAAMC,IAAI,GAAGN,IAAI,CAACI,GAAL,CAASN,IAAI,CAACjD,CAAd,EAAiBX,SAAS,CAACqE,YAA3B,CAAb;AACA,YAAM7D,GAAG,GAAGsD,IAAI,CAACI,GAAL,CAASF,MAAT,EAAiBI,IAAjB,CAAZ;AACA,YAAME,MAAM,GAAGR,IAAI,CAACC,GAAL,CAASC,MAAT,EAAiBI,IAAjB,CAAf;AACA,YAAM3D,IAAI,GAAGqD,IAAI,CAACI,GAAL,CAASL,MAAT,EAAiBI,IAAjB,CAAb;AACA,YAAMM,KAAK,GAAGT,IAAI,CAACC,GAAL,CAASF,MAAT,EAAiBI,IAAjB,CAAd;AACA,YAAMO,MAAM,GAAG,EAAf;AACA,YAAMC,KAAK,GAAG,EAAd;;AAEA,eAAO;AACLZ,UAAAA,MAAM,EAANA,MADK;AAELG,UAAAA,MAAM,EAANA,MAFK;AAGLC,UAAAA,IAAI,EAAJA,IAHK;AAILG,UAAAA,IAAI,EAAJA,IAJK;AAKL5D,UAAAA,GAAG,EAAHA,GALK;AAML8D,UAAAA,MAAM,EAANA,MANK;AAOL7D,UAAAA,IAAI,EAAJA,IAPK;AAQL8D,UAAAA,KAAK,EAALA,KARK;AASLlD,UAAAA,KAAK,EAAEkD,KAAK,GAAG9D,IATV;AAULa,UAAAA,MAAM,EAAEgD,MAAM,GAAG9D,GAVZ;AAWLgE,UAAAA,MAAM,EAANA,MAXK;AAYLC,UAAAA,KAAK,EAALA,KAZK,EAAP;;AAcD,OA3BA,CAFE;;AA+BL3B,MAAAA,SAAS,CAACS,QAAD,CA/BJ,CAAP;;AAiCD,KAlCO,CAL4B;AAwCpCD,IAAAA,GAAG,CAAC,UAAAoB,IAAI,EAAI;AACV,aAAOA,IAAI,CAACrD,KAAL,KAAe,CAAf,IAAoBqD,IAAI,CAACpD,MAAL,KAAgB,CAApC,GAAwC,IAAxC,GAA+CoD,IAAtD;AACD,KAFE,CAxCiC,CAAtC;;;AA6CA,QAAMC,MAAM,GAAGlB,IAAI,CAACnB,IAAL;AACbgB,IAAAA,GAAG,CAAC,UAAAoB,IAAI,EAAI;AACV,UAAIA,IAAI,KAAK,IAAb,EAAmB;AACTrD,QAAAA,KADS,GACoBqD,IADpB,CACTrD,KADS,CACFC,MADE,GACoBoD,IADpB,CACFpD,MADE,CACMb,IADN,GACoBiE,IADpB,CACMjE,IADN,CACYD,GADZ,GACoBkE,IADpB,CACYlE,GADZ;AAEjB,eAAO;AACLY,UAAAA,SAAS,sBAAeX,IAAf,iBAA0BD,GAA1B,QADJ;AAELa,UAAAA,KAAK,EAALA,KAFK;AAGLC,UAAAA,MAAM,EAANA,MAHK,EAAP;;AAKD;;AAED,aAAO,EAAEsD,OAAO,EAAE,MAAX,EAAP;AACD,KAXE,CADU,CAAf;;;AAeA,QAAMC,aAAa,GAAGpB,IAAI,CAACqB,SAAL,CAAepD,MAAf,CAAtB;AACA,QAAMqD,eAAe,GAAGJ,MAAM,CAACG,SAAP,CAAiBtD,QAAjB,CAAxB;;AAEA,WAAO,YAAM;AACXqD,MAAAA,aAAa,CAACG,WAAd;AACAD,MAAAA,eAAe,CAACC,WAAhB;AACD,KAHD;AAID,GAtHQ,EAsHN,CAAChF,SAAD,EAAYkB,UAAZ,CAtHM,CAAT;;AAwHA,MAAM+D,MAAM,GAAGC,WAAW,CAAC,YAAM;AAC/BtD,IAAAA,aAAa,CAAC,KAAD,CAAb;AACAE,IAAAA,sBAAsB,CAAC,KAAD,CAAtB;AACAJ,IAAAA,MAAM,CAAC,IAAD,CAAN;AACD,GAJyB,EAIvB,EAJuB,CAA1B;;AAMA,SAAO,EAAEH,KAAK,EAALA,KAAF,EAASE,GAAG,EAAHA,GAAT,EAAcE,UAAU,EAAVA,UAAd,EAA0BsD,MAAM,EAANA,MAA1B,EAAkCpD,mBAAmB,EAAnBA,mBAAlC,EAAP;AACD;;AC7JD;AACA;AACA;AACA;AACA;AACA;AACA,AAAO,SAASsD,YAAT;AACLC,UADK;AAELC,eAFK;AAGLC,mBAHK;AAIL;AACA,MAAMC,SAAS,GAAGC,MAAM,CAAgC,IAAhC,CAAxB;AACAD,EAAAA,SAAS,CAACxD,OAAV,GAAoBsD,eAApB;AACA,MAAMI,OAAO;AACX,eAAaH,mBAAb,GAAmCA,mBAAmB,CAACvD,OAAvD,GAAiE2D,QADnE;;AAGA1D,EAAAA,SAAS,CAAC,YAAM;AACd,QAAM2D,QAAQ,GAAG,IAAIC,SAAJ,CAAcH,OAAd,CAAjB;;AAEAE,IAAAA,QAAQ,CAACE,IAAT,CAAcT,UAAd,EAA0B,UAACtE,CAAD,EAAIgF,KAAJ,EAAc;AACtC,aAAOP,SAAS,CAACxD,OAAjB,KAA6B,UAA7B,IAA2CwD,SAAS,CAACxD,OAAV,CAAkBjB,CAAlB,EAAqBgF,KAArB,CAA3C;AACD,KAFD;;AAIA,WAAO,YAAM;AACXH,MAAAA,QAAQ,CAACI,MAAT,CAAgBX,UAAhB;AACD,KAFD;AAGD,GAVQ,EAUN,CAACA,UAAD,EAAaK,OAAb,CAVM,CAAT;AAWD;;AC9BM,IAAMO,OAAO,GAAG,SAAVA,OAAU,CAACC,EAAD,EAAaC,EAAb,UAA4B,IAAIpC,IAAI,CAACqC,GAAL,CAASD,EAAE,GAAGD,EAAd,CAAhC,EAAhB;;ACMA,IAAMG,UAAU,GAAG,SAAbA,UAAa;;;;;;;;;;AAUd,KATVC,WASU,QATVA,WASU,CARVC,UAQU,QARVA,UAQU,CAPVC,gBAOU,QAPVA,gBAOU,CANVC,kBAMU,QANVA,kBAMU;AACV,MAAMC,UAAU,GAAGJ,WAAW,GAAGE,gBAAjC;AACA,MAAMG,SAAS,GAAGJ,UAAU,GAAGE,kBAA/B;;AAEA,SAAO;AACLH,IAAAA,WAAW,EAAXA,WADK;AAELC,IAAAA,UAAU,EAAVA,UAFK;AAGLC,IAAAA,gBAAgB,EAAhBA,gBAHK;AAILC,IAAAA,kBAAkB,EAAlBA,kBAJK;AAKLE,IAAAA,SAAS,EAATA,SALK;AAMLD,IAAAA,UAAU,EAAVA,UANK;;AAQLE,IAAAA,eARK,2BAQWC,IARX,EAQ2B;AACtB3C,MAAAA,IADsB,GACsC2C,IADtC,CACtB3C,IADsB,CAChBJ,MADgB,GACsC+C,IADtC,CAChB/C,MADgB,CACRO,IADQ,GACsCwC,IADtC,CACRxC,IADQ,CACFJ,MADE,GACsC4C,IADtC,CACF5C,MADE,CACM6C,KADN,GACsCD,IADtC,CACMC,KADN,CACaC,KADb,GACsCF,IADtC,CACaE,KADb,CACoBtC,MADpB,GACsCoC,IADtC,CACoBpC,MADpB,CAC4BC,KAD5B,GACsCmC,IADtC,CAC4BnC,KAD5B;AAE9B,UAAMH,MAAM,GAAGF,IAAI,GAAG,KAAKqC,UAA3B;AACA,UAAMjG,GAAG,GAAGwD,MAAM,GAAG,KAAKyC,UAA1B;AACA,UAAMhG,IAAI,GAAGoD,MAAM,GAAG,KAAK6C,SAA3B;AACA,UAAMnC,KAAK,GAAGN,IAAI,GAAG,KAAKyC,SAA1B;AACA,UAAMpF,MAAM,GAAGwF,KAAK,GAAG,KAAKL,UAA5B;AACA,UAAMpF,KAAK,GAAGwF,KAAK,GAAG,KAAKH,SAA3B;;AAEA,aAAO;AACLpC,QAAAA,MAAM,EAANA,MADK;AAEL9D,QAAAA,GAAG,EAAHA,GAFK;AAGLC,QAAAA,IAAI,EAAJA,IAHK;AAIL8D,QAAAA,KAAK,EAALA,KAJK;AAKLjD,QAAAA,MAAM,EAANA,MALK;AAMLD,QAAAA,KAAK,EAALA,KANK;AAOLmD,QAAAA,MAAM,EAANA,MAPK;AAQLC,QAAAA,KAAK,EAALA,KARK;;AAUL;AACAZ,QAAAA,MAAM,EAAEA,MAAM,GAAG,KAAK6C,SAXjB;AAYLzC,QAAAA,IAAI,EAAEA,IAAI,GAAG,KAAKyC,SAZb;AAaL1C,QAAAA,MAAM,EAAEA,MAAM,GAAG,KAAKyC,UAbjB;AAcLrC,QAAAA,IAAI,EAAEA,IAAI,GAAG,KAAKqC,UAdb,EAAP;;AAgBD,KAjCI;;AAmCLM,IAAAA,eAnCK,2BAmCWH,IAnCX,EAmCuB;AAC1B,UAAM/C,MAAM,GAAGmD,KAAK;AAClBC,MAAAA,KAAK,CAACL,IAAI,CAACnG,IAAL,GAAY,KAAKiG,SAAlB,CADa;AAElB,OAFkB;AAGlBF,MAAAA,kBAAkB,GAAG,CAHH,CAApB;;AAKA,UAAMxC,MAAM,GAAGgD,KAAK;AAClBE,MAAAA,KAAK,CAACN,IAAI,CAACpG,GAAL,GAAW,KAAKiG,UAAjB,CADa;AAElB,OAFkB;AAGlBF,MAAAA,gBAAgB,GAAG,CAHD,CAApB;;AAKA,UAAMtC,IAAI,GAAG+C,KAAK;AAChBC,MAAAA,KAAK,CAACL,IAAI,CAACrC,KAAL,GAAa,KAAKmC,SAAnB,CADW;AAEhB,OAFgB;AAGhBF,MAAAA,kBAAkB,GAAG,CAHL,CAAlB;;AAKA,UAAMpC,IAAI,GAAG4C,KAAK;AAChBE,MAAAA,KAAK,CAACN,IAAI,CAACtC,MAAL,GAAc,KAAKmC,UAApB,CADW;AAEhB,OAFgB;AAGhBF,MAAAA,gBAAgB,GAAG,CAHH,CAAlB;;AAKA,UAAMM,KAAK,GAAGG,KAAK,CAAChB,OAAO,CAACnC,MAAD,EAASI,IAAT,CAAR,EAAwB,CAAxB,EAA2BuC,kBAA3B,CAAnB;AACA,UAAMM,KAAK,GAAGE,KAAK,CAAChB,OAAO,CAAChC,MAAD,EAASI,IAAT,CAAR,EAAwB,CAAxB,EAA2BmC,gBAA3B,CAAnB;AACA,UAAM/B,MAAM,GAAGoC,IAAI,CAACpC,MAApB;AACA,UAAMC,KAAK,GAAGmC,IAAI,CAACnC,KAAnB;;AAEA,aAAO;AACLoC,QAAAA,KAAK,EAALA,KADK;AAELC,QAAAA,KAAK,EAALA,KAFK;AAGLjD,QAAAA,MAAM,EAANA,MAHK;AAILG,QAAAA,MAAM,EAANA,MAJK;AAKLC,QAAAA,IAAI,EAAJA,IALK;AAMLG,QAAAA,IAAI,EAAJA,IANK;AAOLI,QAAAA,MAAM,EAANA,MAPK;AAQLC,QAAAA,KAAK,EAALA,KARK,EAAP;;AAUD,KAvEI,EAAP;;AAyED,CAvFM;;ACHA,IAAM0C,UAAU,GAAG,SAAbA,UAAa;AACxBtD,EAAAA,MADwB,QACxBA,MADwB;AAExBG,EAAAA,MAFwB,QAExBA,MAFwB;AAGxBoD,EAAAA,KAHwB,QAGxBA,KAHwB;AAIxBC,EAAAA,UAJwB,QAIxBA,UAJwB;;;;;;;AAWpBC,IAAAA,UAAU,CAACC,OAAO,CAACF,UAAD,EAAaxD,MAAb,CAAR,EAA8BuD,KAAK,CAACpD,MAAD,CAAnC,CAXU,GAAnB;;ACQA,IAAMwD,qCAA6D,GAAG,SAAhEA,qCAAgE;AACpEJ,EAAAA,KADoE,QAC3EK,KAD2E;AAEpEC,EAAAA,KAFoE,QAE3EC,KAF2E;AAG3EN,EAAAA,UAH2E,QAG3EA,UAH2E;AAIvE,qBAAoD,KAAjDxD,MAAiD,SAAjDA,MAAiD,CAAzCG,MAAyC,SAAzCA,MAAyC,CAAjCC,IAAiC,SAAjCA,IAAiC,CAA3B6C,KAA2B,SAA3BA,KAA2B,CAApBtC,MAAoB,SAApBA,MAAoB,CAAZC,KAAY,SAAZA,KAAY;AACxD,UAAMmD,MAAM,GAAGC,KAAK,CAAChE,MAAD,EAASI,IAAI,GAAG,CAAhB,CAAL;AACZX,MAAAA,GADY,CACR,UAAAwE,CAAC,EAAI;AACR,YAAMC,SAAS,GAAGZ,UAAU,CAAC;AAC3BtD,UAAAA,MAAM,EAAEiE,CADmB;AAE3B9D,UAAAA,MAAM,EAANA,MAF2B;AAG3BoD,UAAAA,KAAK,EAALA,KAH2B;AAI3BM,UAAAA,KAAK,EAALA,KAJ2B;AAK3BL,UAAAA,UAAU,EAAVA,UAL2B,EAAD,CAA5B;;AAOA,YAAIW,OAAO,GAAG9D,GAAG;AACfoD,QAAAA,UAAU,CAACS,SAAD,EAAYX,KAAK,CAACN,KAAD,CAAjB,CADK;AAEfmB,QAAAA,QAAQ,CAACF,SAAD,CAFO,CAAjB;;;AAKA,YAAMF,KAAgB,GAAGK,QAAQ,CAACH,SAAD,EAAYC,OAAZ,CAAR;AACrB,SAACD,SAAD,EAAYC,OAAZ,EAAqBxD,MAArB,EAA6BC,KAA7B,CADqB;AAErB,SAACuD,OAAD,EAAUD,SAAV,EAAqBvD,MAArB,EAA6BC,KAA7B,CAFJ;;AAIA,eAAOoD,KAAP;AACD,OAnBY;AAoBZM,MAAAA,IApBY,CAoBP,UAACC,MAAD,EAASC,MAAT,UAAoBC,UAAU,CAACF,MAAM,CAAC,CAAD,CAAP,EAAYC,MAAM,CAAC,CAAD,CAAlB,CAA9B,EApBO,CAAf;;AAsBA,aAAOT,MAAP;AACD,KA5B4E,GAAtE;;ACHA,IAAMW,yBAAyB,GAAG,SAA5BA,yBAA4B;AACvCC,EAAAA,GADuC,CACvCA,GADuC,yBACjC,UAAC9H,CAAD,UAAeA,CAAf,EADiC;AAEvC+H,EAAAA,GAFuC,QAEvCA,GAFuC;AAGvClC,EAAAA,gBAHuC,QAGvCA,gBAHuC;AAIvCc,EAAAA,UAJuC,QAIvCA,UAJuC;;;;;;;AAWnC,qBAAwD,sCAAtD1E,KAAsD,YAA/C+F,GAA+C,YAA1ClE,MAA0C,YAAlCC,KAAkC;AAC5D,UAAMkE,eAAe,GAAGC,UAAU,CAACjG,KAAD,CAAlC;AACA,UAAMkG,OAAO,GAAGL,GAAG,CAACM,gBAAgB,CAACnG,KAAD,EAAQ0E,UAAR,CAAjB,CAAnB;AACA,UAAM0B,OAAO,GAAGN,GAAG,CAACO,mBAAmB,CAACrG,KAAD,EAAQgG,eAAR,CAApB,CAAnB;AACA,UAAMM,KAAK,GAAGT,GAAG,CAACM,gBAAgB,CAACJ,GAAD,EAAMrB,UAAN,CAAjB,CAAjB;AACA,UAAM6B,KAAK,GAAGT,GAAG,CAACO,mBAAmB,CAACN,GAAD,EAAME,UAAU,CAACF,GAAD,CAAhB,CAApB,CAAH,GAAiD,CAA/D;;AAEA,UAAMS,KAAK,GAAGtB,KAAK,CAACgB,OAAD,EAAUI,KAAK,GAAG,CAAlB,CAAL,CAA0B3F,GAA1B,CAA8B,UAAAwE,CAAC,EAAI;AAC/C,YAAMjE,MAAM,GAAGiE,CAAf;AACA,YAAM7D,IAAI,GAAG6D,CAAb;AACA,YAAMsB,OAAO,GAAGtB,CAAC,KAAKe,OAAtB;AACA,YAAMQ,KAAK,GAAGvB,CAAC,KAAKmB,KAApB;AACA,YAAMjF,MAAM,GAAG,CAACoF,OAAD,GAAW,CAAX,GAAeL,OAA9B;AACA,YAAM3E,IAAI,GAAG,CAACiF,KAAD,GAAS9C,gBAAgB,GAAG,CAA5B,GAAgC2C,KAA7C;AACA,YAAMrC,KAAK,GAAGb,OAAO,CAACnC,MAAD,EAASI,IAAT,CAArB;AACA,YAAM6C,KAAK,GAAGd,OAAO,CAAChC,MAAD,EAASI,IAAT,CAArB;;AAEA,eAAO;AACLP,UAAAA,MAAM,EAANA,MADK;AAELG,UAAAA,MAAM,EAANA,MAFK;AAGLC,UAAAA,IAAI,EAAJA,IAHK;AAILG,UAAAA,IAAI,EAAJA,IAJK;AAKLyC,UAAAA,KAAK,EAALA,KALK;AAMLC,UAAAA,KAAK,EAALA,KANK;AAOLtC,UAAAA,MAAM,EAANA,MAPK;AAQLC,UAAAA,KAAK,EAALA,KARK,EAAP;;AAUD,OApBa,CAAd;;AAsBA,UAAI6E,WAAO,CAACZ,GAAD,EAAME,UAAU,CAACF,GAAD,CAAhB,CAAX,EAAmC;AACjCS,QAAAA,KAAK,CAACI,GAAN;AACD;;AAED,aAAOJ,KAAP;AACD,KA7CwC,GAAlC;;ACJA,SAASK,oBAAT;AACLC,MADK;AAEkB;AACvB,SAAO,mBAAIA,MAAJ,EAAYtB,IAAZ,CAAiB,4DAAEuB,MAAF,iDAAYC,MAAZ;AACtBrB,MAAAA,UAAU,CAACsB,MAAM,CAACF,MAAD,EAAS,CAAT,CAAP,EAAoBE,MAAM,CAACD,MAAD,EAAS,CAAT,CAA1B,CADY,GAAjB;AAEL,GAFK,CAAP;AAGD;;ACLM,IAAME,IAAI,gBAAG1K,KAAK,CAACC,IAAN,CAAW,SAASyK,IAAT;;;;;;;;;;;;AAY5B,KAXDC,SAWC,QAXDA,SAWC,CAVDC,QAUC,QAVDA,QAUC,CATDpK,OASC,QATDA,OASC,CARDqK,yBAQC,QARDA,yBAQC,CAPDC,OAOC,QAPDA,OAOC;AACiBD,EAAAA,yBAAyB,CAAC;AAC1CnG,IAAAA,MAAM,EAAE,CADkC;AAE1CG,IAAAA,MAAM,EAAE8F,SAFkC;AAG1C7F,IAAAA,IAAI,EAAE,CAHoC;AAI1CG,IAAAA,IAAI,EAAE0F,SAAS,GAAG,CAJwB;AAK1CjD,IAAAA,KAAK,EAAE,CALmC;AAM1CC,IAAAA,KAAK,EAAE,CANmC;AAO1CtC,IAAAA,MAAM,EAAE,EAPkC;AAQ1CC,IAAAA,KAAK,EAAE,EARmC,EAAD,CAD1C,yIACO9B,KADP;;;AAYD,MAAMuH,WAAW,GAAGC,UAAU,CAACxH,KAAD,CAAV,KAAsB,CAA1C;;AAEA;AACE,iCAAK,IAAI,EAAC,QAAV,EAAmB,OAAO,EAAEsH,OAA5B,EAAqC,SAAS,EAAEG,QAAQ,CAAC,CAACzK,OAAO,CAAC0K,IAAT,CAAD,CAAxD;AACGN,IAAAA,QAAQ,IAAIA,QAAQ,CAAC,EAAEpH,KAAK,EAALA,KAAF,EAASuH,WAAW,EAAXA,WAAT,EAAD,CADvB,CADF;;;AAKD,CA/BmB,CAAb;;ICFMI,gBAAgB,gBAAGC,aAAa,CAAC,EAAEC,MAAM,EAAEC,EAAV,EAAD,CAAtC;;ACEP,IAAMC,cAAc,GAAG,WAAvB;;AAEA,IAAMC,QAAQ,GAAG,SAAXA,QAAW;AACfC,KADe;AAEfC,QAFe;;;;AAMM,KAHrBC,UAGqB,uEAHC,KAGD,KAFrBN,MAEqB,uDADrB/F,KACqB;AACGmG,EAAAA,KAAK,CAACtH,GAAN,CAAU,UAAAyH,IAAI,UAAIC,MAAM,CAACD,IAAD,EAAOF,QAAP,EAAiB,EAAEL,MAAM,EAANA,MAAF,EAAjB,CAAV,EAAd,CADH,6CACdS,KADc,kBACPC,MADO;AAErB,MAAID,KAAK,KAAKC,MAAV,IAAoBzG,KAAxB,EAA+B;AAC7B,WAAO,CAACwG,KAAD,EAAQC,MAAR,CAAP;AACD;;AAED,MAAIJ,UAAJ,EAAgB;AACd,WAAO,CAAC,EAAD,EAAKI,MAAL,CAAP;AACD;;AAED,SAAO,CAACD,KAAD,EAAQ,EAAR,CAAP;AACD,CAjBD;;AAmBA,IAAME,UAAU,GAAG,SAAbA,UAAa;AACjBJ,IADiB;AAEjBP,MAFiB;AAGd;AACH,MAAIL,UAAU,CAACY,IAAD,CAAV,KAAqB,CAAzB,EAA4B;AAC1B,WAAOC,MAAM,CAACD,IAAD,EAAO,GAAP,EAAY,EAAEP,MAAM,EAANA,MAAF,EAAZ,CAAb;AACD;;AAED,SAAOQ,MAAM,CAACD,IAAD,EAAO,MAAP,EAAe,EAAEP,MAAM,EAANA,MAAF,EAAf,CAAb;AACD,CATD;;;;;;;;;;;AAoBA,IAAaY,kCAAkC,GAAG,SAArCA,kCAAqC;;;;;;;AAOnC,KANbC,SAMa,QANbA,SAMa,CALbb,MAKa,QALbA,MAKa,CAJbK,QAIa,QAJbA,QAIa,CAHbS,SAGa,QAHbA,SAGa,8BAFbC,gBAEa,CAFbA,gBAEa,sCAFM,IAEN,yBADb9G,KACa,QADbA,KACa;AACb,MAAM9B,KAAK,GAAG0I,SAAS,CAAC,CAAD,CAAvB;AACA,MAAM3C,GAAG,GAAG2C,SAAS,CAAC,CAAD,CAArB;;AAEA,MAAIG,SAAS,CAAC7I,KAAD,EAAQ+F,GAAR,CAAT,IAAyB,CAACmC,QAA9B,EAAwC;AACZF,IAAAA,QAAQ,CAAC,CAAChI,KAAD,EAAQ+F,GAAR,CAAD,EAAe,GAAf,EAAoB,IAApB,EAA0B8B,MAA1B,EAAkC/F,KAAlC,CADI,2CAC/BgH,MAD+B,iBACvBC,OADuB;AAEtC,QAAMC,GAAG,GAAGJ,gBAAgB,aAAMP,MAAM,CAACrI,KAAD,EAAQ,KAAR,EAAe,EAAE6H,MAAM,EAANA,MAAF,EAAf,CAAZ,SAA4C,EAAxE;AACA,WAAO;AACFmB,IAAAA,GADE,SACIR,UAAU,CAACxI,KAAD,EAAQ;AACzB6H,MAAAA,MAAM,EAANA,MADyB,EAAR,CADd;AAGAiB,IAAAA,MAHA;AAIFN,IAAAA,UAAU,CAACzC,GAAD,EAAM,EAAE8B,MAAM,EAANA,MAAF,EAAN,CAJR,SAI4BkB,OAJ5B,EAAP;;AAMD;;AAED,MAAME,YAAY,GAAGZ,MAAM,CAACrI,KAAD,EAAQkI,QAAQ,IAAIH,cAApB,EAAoC,EAAEF,MAAM,EAANA,MAAF,EAApC,CAA3B;AACA,MAAMqB,UAAU,GAAGb,MAAM,CAACtC,GAAD,EAAM4C,SAAS,IAAIZ,cAAnB,EAAmC,EAAEF,MAAM,EAANA,MAAF,EAAnC,CAAzB;;AAEA,SAAO,CAACoB,YAAD,EAAeC,UAAf,CAAP;AACD,CA1BM;;AA4BP,IAAaC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,OAAD,EAAsB;AACvD,SAAOX,kCAAkC,CAACW,OAAD,CAAlC,CAA4CC,IAA5C,CAAiD,KAAjD,CAAP;AACD,CAFM;;ACpDA,IAAMC,YAAY,gBAAG9M,KAAK,CAACC,IAAN,CAAW,SAAS6M,YAAT;;;;;;;;;AASjB,eARpB5K,KAQoB,QARpBA,KAQoB,CAPpBC,MAOoB,QAPpBA,MAOoB,CANpB3B,OAMoB,QANpBA,OAMoB,CALpB0L,SAKoB,QALpBA,SAKoB,CAJpBa,OAIoB,QAJpBA,OAIoB,CAHpBC,KAGoB,QAHpBA,KAGoB,CAFpB1H,KAEoB,QAFpBA,KAEoB,CADpB2H,iBACoB,QADpBA,iBACoB;AACDC,EAAAA,UAAU,CAAC/B,gBAAD,CADT,CACZE,MADY,eACZA,MADY;AAECY,EAAAA,kCAAkC,CAAC;AACtDC,IAAAA,SAAS,EAATA,SADsD;AAEtDb,IAAAA,MAAM,EAANA,MAFsD;AAGtDe,IAAAA,gBAAgB,EAAE,KAHoC;AAItD9G,IAAAA,KAAK,EAALA,KAJsD,EAAD,CAFnC,mEAEb9B,KAFa,6BAEN+F,GAFM;;AAQpB,MAAM4D,sBAAsB,GAAGhL,MAAM,GAAG,EAAT,GAAc,QAAd,GAAyB,EAAxD;;AAEA;AACE;AACE,MAAA,KAAK,EAAE;AACLD,QAAAA,KAAK,EAAEA,KAAK,GAAG,CADV;AAELC,QAAAA,MAAM,EAAEA,MAAM,GAAG,CAFZ;AAGLiL,QAAAA,OAAO,EAAED,sBAHJ,EADT;;AAME,MAAA,SAAS,EAAElC,QAAQ,CAAC;AAClBzK,MAAAA,OAAO,CAAC,eAAD,CADW;;AAGfA,MAAAA,OAAO,CAAC,kBAAD,CAHQ,EAGe8E,KAHf;AAIf9E,MAAAA,OAAO,CAAC,gBAAD,CAJQ,EAIayM,iBAAiB,GAAG,CAJjC,UAAD,CANrB;;;;AAcE,wBAAC,cAAD;AACGN,IAAAA,mBAAmB,CAAC,EAAET,SAAS,EAATA,SAAF,EAAab,MAAM,EAANA,MAAb,EAAqB/F,KAAK,EAALA,KAArB,EAAD,CADtB,CAdF;;AAiBG2H,IAAAA,iBAAiB,GAAG,CAApB;AACC,wBAAC,KAAD,CAAO,QAAP;AACE,kCAAM,mBAAN,EAAkB,SAAS,EAAEzM,OAAO,CAACgD,KAArC;AACGuJ,IAAAA,OAAO,IAAIvJ,KADd,CADF;;AAIGyJ,IAAAA,iBAAiB,GAAG,CAApB;AACC,kCAAM,mBAAN,EAAkB,SAAS,EAAEzM,OAAO,CAAC+I,GAArC;AACGjE,IAAAA,KAAK,GAAGA,KAAH,GAAW0H,KAAK,IAAIzD,GAD5B,CALJ,CAlBJ,CADF;;;;;;;AAgCD,CAnD2B,CAArB;;ACLA,IAAM8D,QAAQ,gBAAGrN,KAAK,CAACC,IAAN,CAAW,SAASoN,QAAT;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BhC,eA3BD7M,OA2BC,SA3BDA,OA2BC,CA1BD8M,IA0BC,SA1BDA,IA0BC,CAzBD/M,UAyBC,SAzBDA,UAyBC,CAxBDD,SAwBC,SAxBDA,SAwBC,CAvBDiN,SAuBC,SAvBDA,SAuBC,CAtBDrC,IAsBC,SAtBDA,IAsBC,CArBDsC,SAqBC,SArBDA,SAqBC,CApBDC,QAoBC,SApBDA,QAoBC,CAnBDC,mBAmBC,SAnBDA,mBAmBC,CAlBDC,WAkBC,SAlBDA,WAkBC,CAjBDC,QAiBC,SAjBDA,QAiBC,CAhBDC,cAgBC,SAhBDA,cAgBC,CAfD/C,OAeC,SAfDA,OAeC,CAdDgD,WAcC,SAdDA,WAcC,+BAbDC,qBAaC,CAbsBC,qBAatB,sCAb8ClB,YAa9C,uDAZDmB,kBAYC,CAZmBC,kBAYnB,sCAZwCnO,yBAYxC,yBAXDU,QAWC,SAXDA,QAWC,CAVDwM,iBAUC,SAVDA,iBAUC,CATDkB,eASC,SATDA,eASC;AACD,MAAMhO,GAAG,GAAGkG,MAAM,CAAC,IAAD,CAAlB,CADC;AAEuCrE,EAAAA,QAAQ,CAACkJ,IAAD,CAF/C,2CAEMkD,YAFN,iBAEoBC,eAFpB;AAGD,MAAMC,YAAY,GAAGC,OAAO,CAAC,oBAAMjB,IAAI,CAAC9F,eAAL,CAAqB0D,IAArB,CAAN,EAAD,EAAmC,CAACA,IAAD,EAAOoC,IAAP,CAAnC,CAA5B;AACA,MAAM/H,IAAI,GAAGgJ,OAAO,CAAC,oBAAMjB,IAAI,CAAC9F,eAAL,CAAqB4G,YAArB,CAAN,EAAD,EAA2C;AAC7DA,EAAAA,YAD6D;AAE7Dd,EAAAA,IAF6D,CAA3C,CAApB;;;AAKAzK,EAAAA,SAAS,CAAC,YAAM;AACdwL,IAAAA,eAAe,CAACnD,IAAD,CAAf;AACD,GAFQ,EAEN,CAACA,IAAD,CAFM,CAAT;;AAIA,MAAMsD,iBAAiB,GAAGD,OAAO,CAAC,oBAAMb,mBAAmB,CAACU,YAAD,CAAzB,EAAD,EAA0C;AACzEV,EAAAA,mBADyE;AAEzEU,EAAAA,YAFyE,CAA1C,CAAjC,CAbC;;;AAkBK/M,EAAAA,GAlBL,GAkBkCkE,IAlBlC,CAkBKlE,GAlBL,CAkBUC,IAlBV,GAkBkCiE,IAlBlC,CAkBUjE,IAlBV,CAkBgBY,KAlBhB,GAkBkCqD,IAlBlC,CAkBgBrD,KAlBhB,CAkBuBC,MAlBvB,GAkBkCoD,IAlBlC,CAkBuBpD,MAlBvB;AAmBDD,EAAAA,KAAK,GAAGA,KAAK,GAAG+K,iBAAhB;;AAEA,MAAMF,OAAO,GAAGzM,SAAS,KAAK,CAA9B;AACA,MAAM0M,KAAK,GAAG1M,SAAS,KAAKiN,SAAS,CAACkB,MAAV,GAAmB,CAA/C;;AAEA,MAAMC,UAAU,GAAG3I,WAAW,CAAC,YAAM;AACnC,QAAI,CAAC0H,QAAD,IAAahN,QAAjB,EAA2B;AACzB;AACD;;AAEDgN,IAAAA,QAAQ,CAACC,mBAAmB,CAACU,YAAD,CAApB,EAAoC7N,UAApC,CAAR;AACD,GAN6B,EAM3B,CAAC6N,YAAD,EAAe7N,UAAf,EAA2BE,QAA3B,EAAqCiN,mBAArC,EAA0DD,QAA1D,CAN2B,CAA9B;;AAQA,MAAMrN,QAAQ,GAAGmO,OAAO,CAAC,oBAAMT,WAAW,CAAC,EAAExN,SAAS,EAATA,SAAF,EAAaC,UAAU,EAAVA,UAAb,EAAD,CAAjB,EAAD,EAA+C;AACrED,EAAAA,SADqE;AAErEC,EAAAA,UAFqE;AAGrEuN,EAAAA,WAHqE,CAA/C,CAAxB;;;AAMA9H,EAAAA,YAAY;AACV,MADU;AAEV,cAAM;AACJ,QAAI,CAACyH,QAAD,IAAahN,QAAb,IAAyB,CAACL,QAA9B,EAAwC;AACtC;AACD;;AAED,QAAIwN,QAAQ,KAAK,MAAb,IAAuBA,QAAQ,KAAK,GAAxC,EAA6C;AAC3C;AACD;;AAED,QAAIQ,YAAY,CAACvJ,MAAb,KAAwB,CAA5B,EAA+B;AAC7B;AACD;;AAED,QAAM8J,OAAO;AACRP,IAAAA,YADQ;AAEXvJ,MAAAA,MAAM,EAAEuJ,YAAY,CAACvJ,MAAb,GAAsB,CAFnB;AAGXI,MAAAA,IAAI,EAAEmJ,YAAY,CAACnJ,IAAb,GAAoB,CAHf,GAAb;;;AAMAwI,IAAAA,QAAQ,CAACC,mBAAmB,CAACiB,OAAD,CAApB,EAA+BpO,UAA/B,CAAR;AACD,GAtBS;AAuBVJ,EAAAA,GAvBU,CAAZ;;;AA0BA6F,EAAAA,YAAY;AACV,YADU;AAEV,cAAM;AACJ,QAAI,CAACyH,QAAD,IAAa,CAACE,WAAd,IAA6BlN,QAA7B,IAAyC,CAACL,QAA9C,EAAwD;AACtD;AACD;;AAED;AACEgO,IAAAA,YAAY,CAACnJ,IAAb,KAAsBmJ,YAAY,CAACvJ,MAAnC;AACAuJ,IAAAA,YAAY,CAACzG,KAAb,KAAuB,CAFzB;AAGE;AACA;AACD;;AAED,QAAMgH,OAAO;AACRP,IAAAA,YADQ;AAEXnJ,MAAAA,IAAI,EAAEmJ,YAAY,CAACnJ,IAAb,GAAoB,CAFf;AAGX0C,MAAAA,KAAK,EAAEyG,YAAY,CAACzG,KAAb,GAAqB,CAHjB,GAAb;;;AAMA8F,IAAAA,QAAQ,CAACC,mBAAmB,CAACiB,OAAD,CAApB,EAA+BpO,UAA/B,CAAR;AACD,GArBS;AAsBVJ,EAAAA,GAtBU,CAAZ;;;AAyBA6F,EAAAA,YAAY;AACV,QADU;AAEV,cAAM;AACJ,QAAI,CAACyH,QAAD,IAAahN,QAAb,IAAyB,CAACL,QAA9B,EAAwC;AACtC;AACD;;AAED,QAAIwN,QAAQ,KAAK,MAAb,IAAuBA,QAAQ,KAAK,GAAxC,EAA6C;AAC3C;AACD;;AAED,QAAIjJ,IAAI,CAACoD,KAAL,CAAWqG,YAAY,CAACnJ,IAAxB,KAAiCqI,IAAI,CAAClG,gBAAL,GAAwB,CAA7D,EAAgE;AAC9D;AACD;;AAED,QAAMuH,OAAO;AACRP,IAAAA,YADQ;AAEXvJ,MAAAA,MAAM,EAAEuJ,YAAY,CAACvJ,MAAb,GAAsB,CAFnB;AAGXI,MAAAA,IAAI,EAAEmJ,YAAY,CAACnJ,IAAb,GAAoB,CAHf,GAAb;;;AAMAwI,IAAAA,QAAQ,CAACC,mBAAmB,CAACiB,OAAD,CAApB,EAA+BpO,UAA/B,CAAR;AACD,GAtBS;AAuBVJ,EAAAA,GAvBU,CAAZ;;;AA0BA6F,EAAAA,YAAY;AACV,cADU;AAEV,cAAM;AACJ,QAAI,CAACyH,QAAD,IAAa,CAACE,WAAd,IAA6BlN,QAA7B,IAAyC,CAACL,QAA9C,EAAwD;AACtD;AACD;;AAED,QAAIwN,QAAQ,KAAK,MAAb,IAAuBA,QAAQ,KAAK,GAAxC,EAA6C;AAC3C;AACD;;AAED,QAAIjJ,IAAI,CAACoD,KAAL,CAAWqG,YAAY,CAACnJ,IAAxB,KAAiCqI,IAAI,CAAClG,gBAAL,GAAwB,CAA7D,EAAgE;AAC9D;AACD;;AAED,QAAMuH,OAAO;AACRP,IAAAA,YADQ;AAEXzG,MAAAA,KAAK,EAAEyG,YAAY,CAACzG,KAAb,GAAqB,CAFjB;AAGX1C,MAAAA,IAAI,EAAEmJ,YAAY,CAACnJ,IAAb,GAAoB,CAHf,GAAb;;;AAMAwI,IAAAA,QAAQ,CAACC,mBAAmB,CAACiB,OAAD,CAApB,EAA+BpO,UAA/B,CAAR;AACD,GAtBS;AAuBVJ,EAAAA,GAvBU,CAAZ;;;AA0BA,MAAMyO,UAAiC,GAAG7I,WAAW;AACnD,YAACjF,KAAD,SAAqB,KAAXU,CAAW,SAAXA,CAAW,CAARD,CAAQ,SAARA,CAAQ;AACnB,QAAIqM,QAAQ,KAAK,MAAb,IAAuBnN,QAA3B,EAAqC;AACnC;AACD;;AAEDK,IAAAA,KAAK,CAACc,cAAN;AACAd,IAAAA,KAAK,CAACe,eAAN;;AAEA,QAAMgN,OAAO;AACRtJ,IAAAA,IADQ,CAAb;;;AAIA,QAAIqI,QAAQ,KAAK,MAAb,IAAuBA,QAAQ,KAAK,GAAxC,EAA6C;AAC3C,UAAMkB,WAAW,GAAGtN,CAApB;AACA,UAAMuN,WAAW,GAAGD,WAAW,GAAGvJ,IAAI,CAACpD,MAAvC;AACA,UAAM6M,MAAM,GAAGrK,IAAI,CAACI,GAAL,CAAS+J,WAAT,EAAsBC,WAAtB,CAAf;AACA,UAAME,SAAS,GAAGD,MAAM,GAAGzJ,IAAI,CAACpD,MAAhC;AACA0M,MAAAA,OAAO,CAAC1J,MAAR,GAAiB8J,SAAjB;AACAJ,MAAAA,OAAO,CAACxN,GAAR,GAAc2N,MAAd;AACD;;AAED,QAAIpB,QAAQ,KAAK,MAAb,IAAuBA,QAAQ,KAAK,GAAxC,EAA6C;AAC3C,UAAMkB,WAAW,GAAGvN,CAApB;AACA,UAAMwN,YAAW,GAAGD,WAAW,GAAGvJ,IAAI,CAACrD,KAAvC;AACA,UAAMgN,OAAO,GAAGvK,IAAI,CAACI,GAAL,CAAS+J,WAAT,EAAsBC,YAAtB,CAAhB;AACA,UAAMI,QAAQ,GAAGD,OAAO,GAAG3J,IAAI,CAACrD,KAAhC;AACA2M,MAAAA,OAAO,CAACzJ,KAAR,GAAgB+J,QAAhB;AACAN,MAAAA,OAAO,CAACvN,IAAR,GAAe4N,OAAf;AACD,KA5BkB;;AA8BQ5B,IAAAA,IAAI,CAAC1F,eAAL,CAAqBiH,OAArB,CA9BR,CA8BXhK,MA9BW,yBA8BXA,MA9BW,CA8BHH,MA9BG,yBA8BHA,MA9BG;;AAgCnB,QAAMiK,OAAO;AACRzD,IAAAA,IADQ;AAEXxG,MAAAA,MAAM,EAAEkJ,QAAQ,KAAK,GAAb,GAAmB1C,IAAI,CAACxG,MAAxB,GAAiCA,MAF9B;AAGXI,MAAAA,IAAI,EAAE8I,QAAQ,KAAK,GAAb,GAAmBlJ,MAAM,GAAGwG,IAAI,CAACxD,KAAd,GAAsB,CAAzC,GAA6CwD,IAAI,CAACpG,IAH7C;AAIXD,MAAAA,MAAM,EAAE+I,QAAQ,KAAK,GAAb,GAAmB1C,IAAI,CAACrG,MAAxB,GAAiCA,MAJ9B;AAKXI,MAAAA,IAAI,EAAE2I,QAAQ,KAAK,GAAb,GAAmB/I,MAAM,GAAGqG,IAAI,CAACvD,KAAd,GAAsB,CAAzC,GAA6CuD,IAAI,CAACjG,IAL7C,GAAb;;;AAQAmK,IAAAA,SAAS;AACPT,IAAAA,OAAO,CAAChH,KAAR,KAAkBuD,IAAI,CAACvD,KAAvB,IAAgCgH,OAAO,CAACjH,KAAR,KAAkBwD,IAAI,CAACxD,KADhD,+DAAT;;;;AAKA2G,IAAAA,eAAe,CAACM,OAAD,CAAf;AACD,GA/CkD;AAgDnD,GAACrB,IAAD,EAAO/H,IAAP,EAAaqI,QAAb,EAAuBnN,QAAvB,EAAiCyK,IAAjC,EAAuCmD,eAAvC,CAhDmD,CAArD;;;AAmDA,MAAMgB,YAA4B,GAAGtJ,WAAW;AAC9C,YAACjF,KAAD,EAAQwO,SAAR,EAAmBC,IAAnB,EAAyBC,KAAzB,EAAmC;AACjC,QAAI,CAAC7B,WAAD,IAAgBlN,QAApB,EAA8B;AAC5B;AACD;;AAEDK,IAAAA,KAAK,CAACc,cAAN;AACAd,IAAAA,KAAK,CAACe,eAAN;;AAEA,QAAI2N,KAAK,CAACrN,MAAN,KAAiB,CAArB,EAAwB;AACtB;AACD;;AAED,QAAMsN,OAAO,GAAG;AACdtN,MAAAA,MAAM,EAAEqN,KAAK,CAACrN,MAAN,GAAeoD,IAAI,CAACpD,MADd;AAEdD,MAAAA,KAAK,EAAEsN,KAAK,CAACtN,KAAN,GAAcqD,IAAI,CAACrD,KAAnB,GAA2B,EAFpB,EAAhB;;;AAKA,QAAM2M,OAAO;AACRP,IAAAA,YADQ;AAERmB,IAAAA,OAFQ,CAAb;;;AAKA,QAAIH,SAAS,CAACI,QAAV,CAAmB,KAAnB,CAAJ,EAA+B;AAC7Bb,MAAAA,OAAO,CAACxN,GAAR,IAAemO,KAAK,CAACrN,MAArB;AACD,KAFD,MAEO,IAAImN,SAAS,CAACI,QAAV,CAAmB,QAAnB,CAAJ,EAAkC;AACvCb,MAAAA,OAAO,CAAC1J,MAAR,IAAkBqK,KAAK,CAACrN,MAAxB;AACD,KA1BgC;;AA4BDmL,IAAAA,IAAI,CAAC1F,eAAL,CAAqBiH,OAArB,CA5BC,CA4BzBlH,KA5ByB,0BA4BzBA,KA5ByB,CA4BlB9C,MA5BkB,0BA4BlBA,MA5BkB,CA4BVI,IA5BU,0BA4BVA,IA5BU;AA6BjC,QAAM0J,OAAO;AACRzD,IAAAA,IADQ;AAEXvD,MAAAA,KAAK,EAALA,KAFW;AAGX9C,MAAAA,MAAM,EAANA,MAHW;AAIXI,MAAAA,IAAI,EAAJA,IAJW,GAAb;;;AAOAoJ,IAAAA,eAAe,CAACM,OAAD,CAAf;AACD,GAtC6C;AAuC9C,GAACrB,IAAD,EAAO/H,IAAP,EAAa9E,QAAb,EAAuBkN,WAAvB,EAAoCU,eAApC,EAAqDnD,IAArD,EAA2DoD,YAA3D,CAvC8C,CAAhD;;;AA0CA,MAAMjO,YAAY,GAAG0F,WAAW,CAAC,YAAM;AACrC,QAAI,CAAC0H,QAAD,IAAahN,QAAjB,EAA2B;AACzB;AACD;;AAEDgN,IAAAA,QAAQ,CAACkC,SAAD,EAAYpP,UAAZ,CAAR;AACD,GAN+B,EAM7B,CAACkN,QAAD,EAAWhN,QAAX,EAAqBF,UAArB,CAN6B,CAAhC;;AAQA,MAAMqP,aAAa,GAAG7J,WAAW,CAAC,YAAM;AACtC,QAAI,CAAC8H,cAAD,IAAmBpN,QAAvB,EAAiC;AAC/B;AACD;;AAEDoN,IAAAA,cAAc,CAAC,CAACtN,UAAD,EAAaD,SAAb,CAAD,CAAd;AACD,GANgC,EAM9B,CAACuN,cAAD,EAAiBpN,QAAjB,EAA2BF,UAA3B,EAAuCD,SAAvC,CAN8B,CAAjC;;AAQA,MAAMuP,aAAa,GAAG9J,WAAW,CAAC,YAAM;AACtC,QAAI,CAAC+E,OAAD,IAAYrK,QAAZ,IAAwB,CAACL,QAA7B,EAAuC;AACrC;AACD;;AAED0K,IAAAA,OAAO,CAAC,CAACvK,UAAD,EAAaD,SAAb,CAAD,CAAP;AACD,GANgC,EAM9B,CAACwK,OAAD,EAAUvK,UAAV,EAAsBE,QAAtB,EAAgCL,QAAhC,EAA0CE,SAA1C,CAN8B,CAAjC;;AAQA0F,EAAAA,YAAY,CAAC,OAAD,EAAU6J,aAAV,EAAyB1P,GAAzB,CAAZ;;AAEA,MAAM2P,aAAa,GAAGvB,OAAO;AAC3B;AACE/N,MAAAA,OAAO,CAACuP,MAAR;AACIvP,MAAAA,OAAO,CAACuP,MAAR;AACGC,MAAAA,KADH,CACS,GADT;AAEG7L,MAAAA,GAFH,CAEO,UAAAqJ,SAAS,qBAAQA,SAAR,GAFhB;AAGGX,MAAAA,IAHH,CAGQ,IAHR,CADJ;AAKI8C,MAAAA,SANN,GAD2B;AAQ3B,GAACnP,OAAO,CAACuP,MAAT,CAR2B,CAA7B;;;AAWA;AACE,wBAAC,SAAD;AACE,MAAA,IAAI,EAAEnC,QADR;AAEE,MAAA,MAAM,EAAE;AACNvM,QAAAA,GAAG,EAAE,CADC;AAEN8D,QAAAA,MAAM,EAAEmI,IAAI,CAACpG,WAAL,GAAmB/E,MAFrB;AAGNb,QAAAA,IAAI,EAAE,CAHA;AAIN8D,QAAAA,KAAK,EAAEkI,IAAI,CAACnG,UAAL,GAAkB8F,iBAJnB,EAFV;;AAQE,MAAA,QAAQ,EAAE,EAAE1L,CAAC,EAAED,IAAL,EAAWE,CAAC,EAAEH,GAAd,EARZ;AASE,MAAA,MAAM,EAAEuN,UATV;AAUE,MAAA,MAAM,EAAEF,UAVV;AAWE,MAAA,MAAM,EAAEoB,aAXV;AAYE,MAAA,QAAQ,EAAErP,QAZZ;;AAcE,wBAAC,kBAAD;AACE,MAAA,IAAI,EAAC,QADP;AAEE,MAAA,QAAQ,EAAEA,QAFZ;AAGE,MAAA,OAAO,EAAEmP,aAHX;AAIE,MAAA,OAAO,EAAEC,aAJX;AAKE,MAAA,YAAY,EAAExP,YALhB;AAME,MAAA,SAAS,EAAEC,SANb;AAOE,MAAA,UAAU,EAAEC,UAPd;AAQE,MAAA,QAAQ,EAAEH,QARZ;AASE,MAAA,OAAO,EAAEI,OATX;AAUE,MAAA,SAAS,EAAEyK,QAAQ,CAAC;AAClBzK,MAAAA,OAAO,CAACM,KADU;AAElBN,MAAAA,OAAO,CAAC,aAAD,CAFW;AAGlBgN,MAAAA,SAHkB;;AAKfhN,MAAAA,OAAO,CAAC,cAAD,CALQ,EAKW,CAACC,QAAD,IAAamN,QAAQ,KAAK,MALrC;AAMfpN,MAAAA,OAAO,CAAC,aAAD,CANQ,EAMUC,QANV,UAAD,CAVrB;;;AAmBE,MAAA,GAAG,EAAEN,GAnBP;AAoBE,MAAA,KAAK,EAAE;AACL+B,QAAAA,KAAK,EAAEA,KAAK,GAAG,CADV;AAELC,QAAAA,MAAM,EAAEA,MAAM,GAAG,CAFZ;AAGL8N,QAAAA,UAAU;AACRhD,QAAAA,iBAAiB,KAAK,CAAtB;AACI,aADJ;AAEO/K,QAAAA,KAAK,GAAGiM,eAAR,GAA0BjM,KAA1B,GAAkC,CAFzC,OAJG;AAOLgO,QAAAA,SAAS,EAAE,KAPN,EApBT;;;AA8BE,wBAAC,SAAD;AACE,MAAA,IAAI;AACC5B,MAAAA,YADD;AAEFpM,QAAAA,KAAK,EAAEoM,YAAY,CAACpM,KAAb,GAAqB+K,iBAArB,GAAyC,CAF9C,GADN;;AAKE,MAAA,GAAG,YAAK1M,UAAL,cAAmBD,SAAnB,cAAgCiN,SAAS,CAACkB,MAA1C,cAAoDH,YAAY,CAACjN,GAAjE,cAAwEiN,YAAY,CAAChN,IAArF,CALL;AAME,MAAA,QAAQ,EAAE+N,YANZ;AAOE,MAAA,YAAY,EAAEX,UAPhB;AAQE,MAAA,kBAAkB,EAAElO,OAAO,CAAC,gBAAD,CAR7B;AASE,MAAA,MAAM;AACJmN,MAAAA,WAAW,IAAI,CAAClN,QAAhB;AACI;AACEY,QAAAA,GAAG,EAAE,IADP;AAEE8D,QAAAA,MAAM,EAAE,IAFV,EADJ;;AAKI,QAfR;;AAiBE,MAAA,aAAa,EAAE;AACbA,QAAAA,MAAM,EAAE8F,QAAQ,CAAC,CAACzK,OAAO,CAACuP,MAAT,EAAiBvP,OAAO,CAAC2E,MAAzB,CAAD,CADH;AAEbgL,QAAAA,UAAU,EAAE3P,OAAO,CAACuP,MAFP;AAGbK,QAAAA,WAAW,EAAE5P,OAAO,CAACuP,MAHR;AAIbzO,QAAAA,IAAI,EAAEd,OAAO,CAACuP,MAJD;AAKb3K,QAAAA,KAAK,EAAE5E,OAAO,CAACuP,MALF;AAMb1O,QAAAA,GAAG,EAAE4J,QAAQ,CAAC,CAACzK,OAAO,CAACuP,MAAT,EAAiBvP,OAAO,CAACa,GAAzB,CAAD,CANA;AAObgP,QAAAA,OAAO,EAAE7P,OAAO,CAACuP,MAPJ;AAQbO,QAAAA,QAAQ,EAAE9P,OAAO,CAACuP,MARL,EAjBjB;;;AA4BE,wBAAC,qBAAD;AACE,MAAA,KAAK,EAAE7N,KADT;AAEE,MAAA,MAAM,EAAEC,MAFV;AAGE,MAAA,OAAO,EAAE3B,OAHX;AAIE,MAAA,SAAS,EAAEgO,iBAJb;AAKE,MAAA,OAAO,EAAEzB,OALX;AAME,MAAA,KAAK,EAAEC,KANT;AAOE,MAAA,KAAK,EAAE9B,IAAI,CAAC5F,KAPd;AAQE,MAAA,iBAAiB,EAAE2H,iBARrB,GA5BF,CA9BF,CAdF,CADF;;;;;;AAuFD,CAlYuB,CAAjB;;ACYA,IAAMsD,QAAQ,gBAAGvQ,KAAK,CAACC,IAAN,CAAW,SAASsQ,QAAT;;;;;;;;;;;;;;;;;;;;;AAqBhB,KApBjB/P,OAoBiB,QApBjBA,OAoBiB,CAnBjB8J,MAmBiB,QAnBjBA,MAmBiB,CAlBjBgD,IAkBiB,QAlBjBA,IAkBiB,CAjBjBE,SAiBiB,QAjBjBA,SAiBiB,CAhBjBC,QAgBiB,QAhBjBA,QAgBiB,CAfjBE,WAeiB,QAfjBA,WAeiB,CAdjB6C,WAciB,QAdjBA,WAciB,CAbjB5C,QAaiB,QAbjBA,QAaiB,CAZjBF,mBAYiB,QAZjBA,mBAYiB,CAXjB+C,gBAWiB,QAXjBA,gBAWiB,CAVjB5C,cAUiB,QAVjBA,cAUiB,CATjBE,qBASiB,QATjBA,qBASiB,CARjBE,kBAQiB,QARjBA,kBAQiB,CAPjBnD,OAOiB,QAPjBA,OAOiB,CANjBgD,WAMiB,QANjBA,WAMiB;AACjB,MAAM4C,mBAA8C,GAAG,EAAvD;;AAEApG,EAAAA,MAAM,CAACnG,GAAP,CAAW,UAACwM,cAAD,EAAiBC,mBAAjB,EAAyC;AAClDtG,IAAAA,MAAM,CAACnG,GAAP,CAAW,UAAC0M,YAAD,EAAeC,iBAAf,EAAqC;AAC9C,UAAMC,SAAS,GAAGH,mBAAmB,KAAKE,iBAA1C;AACA,UAAME,iBAAiB;AACrBL,MAAAA,cAAc,CAAC,CAAD,CAAd,GAAoBE,YAAY,CAAC,CAAD,CAAhC;AACAF,MAAAA,cAAc,CAAC,CAAD,CAAd,GAAoBE,YAAY,CAAC,CAAD,CAFlC;AAGA,UAAI,CAACE,SAAD,IAAcC,iBAAlB,EAAqC;AACnCN,QAAAA,mBAAmB,CAACO,IAApB;AACGL,QAAAA,mBADH,EACyBE,iBAAiB,CAACI,QAAlB,EADzB;;AAGD;AACF,KAVD;AAWD,GAZD;;AAcA,MAAMC,gBAAgB,GAAGT,mBAAmB,CAACU,MAApB;AACvB,YAACC,KAAD,EAA8BC,GAA9B,EAA4D;AAC1D,SAAK,IAAIC,GAAT,IAAgBD,GAAhB,EAAqB;AACnBD,MAAAA,KAAK,CAACE,GAAD,CAAL,GAAaF,KAAK,CAACE,GAAD,CAAL,gCAAiBF,KAAK,CAACE,GAAD,CAAtB,IAA6BD,GAAG,CAACC,GAAD,CAAhC,KAAyC,CAACD,GAAG,CAACC,GAAD,CAAJ,CAAtD;AACD;AACD,WAAOF,KAAP;AACD,GANsB;AAOvB,IAPuB,CAAzB;;;AAUA,MAAMG,WAAW,GAAG,SAAdA,WAAc,CAACC,QAAD,EAAgC;AAClD,WAAO,IAAIC,GAAJ,CAAQD,QAAR,EAAkBE,IAAzB;AACD,GAFD;;AAIA,MAAMC,yBAAyB,GAAG,SAA5BA,yBAA4B,CAACrR,UAAD,EAAwB;AACxD,QAAI0M,iBAAiB,GAAG,CAAxB;AACA,QAAIkB,eAAe,GAAG,CAAtB;;AAEA,QAAI,CAACgD,gBAAgB,CAACU,cAAjB,CAAgCtR,UAAhC,CAAL,EAAkD;AAChD,aAAO,EAAE0M,iBAAiB,EAAjBA,iBAAF,EAAqBkB,eAAe,EAAfA,eAArB,EAAP;AACD;;AAEDgD,IAAAA,gBAAgB,CAAC5Q,UAAD,CAAhB,CAA6B4D,GAA7B,CAAiC,UAACwM,cAAD,EAA4B;AAC3D;AACEA,MAAAA,cAAc,KAAKpQ,UAAnB;AACA4Q,MAAAA,gBAAgB,CAAC5Q,UAAD,CAAhB,CAA6BkO,MAA7B,GAAsC,CAFxC;AAGE;AACA,YAAIqD,cAAwB,GAAG,EAA/B;AACA,YAAIC,aAAwB,GAAG,EAA/B;;AAEAZ,QAAAA,gBAAgB,CAAC5Q,UAAD,CAAhB,CAA6B4D,GAA7B,CAAiC,UAACuE,KAAD,EAAmB;AAClDqJ,UAAAA,aAAa,CAACd,IAAd,CAAmB1Q,UAAU,GAAGmI,KAAhC;AACAyI,UAAAA,gBAAgB,CAAC5Q,UAAD,CAAhB,CAA6B4D,GAA7B,CAAiC,UAAC6N,eAAD,EAA6B;AAC5DF,YAAAA,cAAc,CAACb,IAAf,OAAAa,cAAc,qBAASX,gBAAgB,CAACa,eAAD,CAAzB,EAAd;AACD,WAFD;;AAIA/E,UAAAA,iBAAiB;AACfuE,UAAAA,WAAW;AACTM,UAAAA,cAAc,CAACjO,MAAf,CAAsB,UAAAoO,KAAK,UAAIA,KAAK,KAAKtB,cAAd,EAA3B,CADS,CAAX;AAEI,WAHN;AAID,SAVD;AAWAxC,QAAAA,eAAe,GAAG4D,aAAa,CAAClO,MAAd,CAAqB,UAAAqO,CAAC,UAAIA,CAAC,KAAK,IAAV,EAAtB,EAAsCzD,MAAtC,GAA+C,CAAjE;AACD,OAnBD,MAmBO;AACLxB,QAAAA,iBAAiB,GAAG,CAApB;AACA,YAAMkF,wBAAwB,GAAGhB,gBAAgB,CAAC5Q,UAAD,CAAhB,CAA6B,CAA7B,CAAjC;;AAEA,YAAI4Q,gBAAgB,CAACgB,wBAAD,CAAhB,CAA2C1D,MAA3C,GAAoD,CAAxD,EAA2D;AACzDN,UAAAA,eAAe;AACbgD,UAAAA,gBAAgB,CAACgB,wBAAD,CAAhB,CAA2C1D,MAA3C,GAAoD,CADtD;AAED,SAHD,MAGO;AACLN,UAAAA,eAAe;AACb5N,UAAAA,UAAU,GAAG6R,MAAM,MAAN,4BAAUjB,gBAAgB,CAAC5Q,UAAD,CAA1B,EAAb,GAAuD,CAAvD,GAA2D,CAD7D;AAED;;AAED0M,QAAAA,iBAAiB,GAAGtI,IAAI,CAACC,GAAL;AAClB,SADkB;AAElBuM,QAAAA,gBAAgB,CAACgB,wBAAD,CAAhB,CAA2C1D,MAA3C,GAAoD,CAFlC,CAApB;;AAID;AACF,KArCD;;AAuCA,WAAO,EAAExB,iBAAiB,EAAjBA,iBAAF,EAAqBkB,eAAe,EAAfA,eAArB,EAAP;AACD,GAhDD;;AAkDA;AACE,iCAAK,SAAS,EAAE3N,OAAO,CAAC,aAAD,CAAvB;AACG8J,IAAAA,MAAM,CAACnG,GAAP,CAAW,UAAC+H,SAAD,EAAY3L,UAAZ,EAA2B;AACrC,UAAM8R,MAAM,GAAGtJ,QAAQ,CAACmD,SAAS,CAAC,CAAD,CAAV,EAAe,IAAIoG,IAAJ,EAAf,CAAvB;AACA;AACE,sCAAM,GAAG,EAAE/R,UAAX;AACGkQ,QAAAA,gBAAgB,CAACvE,SAAD,CAAhB,CAA4B/H,GAA5B,CAAgC,UAAC+G,IAAD,EAAO5K,SAAP,EAAkBiN,SAAlB,EAAgC;AAC/D,cAAMgF,aAAa,GAAGrH,IAAI,CAAC7F,MAAL,KAAgB,QAAtC,CAD+D;;;;AAK3DuM,UAAAA,yBAAyB,CAACrR,UAAD,CALkC,CAG7D0M,iBAH6D,yBAG7DA,iBAH6D,CAI7DkB,eAJ6D,yBAI7DA,eAJ6D;;AAO/D;AACE,gCAAC,QAAD;AACE,cAAA,OAAO,EAAE3N,OADX;AAEE,cAAA,cAAc,EAAEqN,cAFlB;AAGE,cAAA,GAAG,YAAKtN,UAAL,cAAmB+J,MAAM,CAACmE,MAA1B,cAAoCnO,SAApC,cAAiDiN,SAAS,CAACkB,MAA3D,CAHL;AAIE,cAAA,WAAW,EAAEd,WAJf;AAKE,cAAA,QAAQ,EAAEC,QALZ;AAME,cAAA,WAAW,EAAE4C,WANf;AAOE,cAAA,mBAAmB,EAAE9C,mBAPvB;AAQE,cAAA,SAAS,EAAEH,SARb;AASE,cAAA,SAAS,EAAEjN,SATb;AAUE,cAAA,UAAU,EAAEC,UAVd;AAWE,cAAA,SAAS,EAAE0K,QAAQ,CAAC;AAClBuC,cAAAA,SADkB;;AAGfhN,cAAAA,OAAO,CAAC,SAAD,CAHQ,EAGM6R,MAHN;AAIf7R,cAAAA,OAAO,CAAC,WAAD,CAJQ,EAIQ+R,aAJR,UAAD,CAXrB;;;AAkBE,cAAA,QAAQ,EAAE9E,QAlBZ;AAmBE,cAAA,OAAO,EAAE3C,OAnBX;AAoBE,cAAA,IAAI,EAAEwC,IApBR;AAqBE,cAAA,IAAI,EAAEpC,IArBR;AAsBE,cAAA,WAAW,EAAE4C,WAtBf;AAuBE,cAAA,qBAAqB,EAAEC,qBAvBzB;AAwBE,cAAA,kBAAkB,EAAEE,kBAxBtB;AAyBE,cAAA,QAAQ,EAAEsE,aAzBZ;AA0BE,cAAA,iBAAiB,EAAEtF,iBA1BrB;AA2BE,cAAA,eAAe,EAAEkB,eA3BnB,GADF;;;AA+BD,SAtCA,CADH,CADF;;;AA2CD,KA7CA,CADH,CADF;;;AAkDD,CAxJuB,CAAjB;;ACtBA,IAAMqE,aAAa,gBAAGxS,KAAK,CAACC,IAAN,CAAW,SAASuS,aAAT;;;;;;;;AAQrC,KAPDhS,OAOC,QAPDA,OAOC,CAND8M,IAMC,QANDA,IAMC,CALDpC,IAKC,QALDA,IAKC,8BAJD+C,kBAIC,CAJmBC,kBAInB,sCAJwCnO,yBAIxC;AACD,MAAMwF,IAAI,GAAGgJ,OAAO,CAAC,oBAAMjB,IAAI,CAAC9F,eAAL,CAAqB0D,IAArB,CAAN,EAAD,EAAmC,CAACA,IAAD,EAAOoC,IAAP,CAAnC,CAApB,CADC;AAEOjM,EAAAA,GAFP,GAEoCkE,IAFpC,CAEOlE,GAFP,CAEYC,IAFZ,GAEoCiE,IAFpC,CAEYjE,IAFZ,CAEkBY,KAFlB,GAEoCqD,IAFpC,CAEkBrD,KAFlB,CAEyBC,MAFzB,GAEoCoD,IAFpC,CAEyBpD,MAFzB;;AAID;AACE,wBAAC,SAAD;AACE,MAAA,MAAM,EAAE;AACNd,QAAAA,GAAG,EAAE,CADC;AAEN8D,QAAAA,MAAM,EAAEmI,IAAI,CAACpG,WAAL,GAAmB/E,MAFrB;AAGNb,QAAAA,IAAI,EAAE,CAHA;AAIN8D,QAAAA,KAAK,EAAEkI,IAAI,CAACnG,UAJN,EADV;;AAOE,MAAA,QAAQ,EAAE,EAAE5F,CAAC,EAAED,IAAL,EAAWE,CAAC,EAAEH,GAAd,EAPZ;AAQE,MAAA,GAAG,sBAAea,KAAf,cAAwBC,MAAxB,cAAkCd,GAAlC,cAAyCC,IAAzC,CARL;;AAUE,wBAAC,kBAAD;AACE,MAAA,SAAS,EAAE2J,QAAQ,CAAC,CAACzK,OAAO,CAACiS,SAAT,CAAD,CADrB;AAEE,MAAA,KAAK,EAAE;AACLvQ,QAAAA,KAAK,EAAEA,KADF;AAELC,QAAAA,MAAM,EAAE,CAFH,EAFT;;AAME,MAAA,GAAG,sBAAeD,KAAf,cAAwBC,MAAxB,cAAkCd,GAAlC,cAAyCC,IAAzC,CANL,GAVF,CADF;;;;AAqBD,CAjC4B,CAAtB;;ACKA,IAAMoR,aAAa,gBAAG1S,KAAK,CAACC,IAAN,CAAW,SAASyS,aAAT;;;;;;;;;;;;;AAahB,KAZtBlS,OAYsB,QAZtBA,OAYsB,CAXtBmS,WAWsB,QAXtBA,WAWsB,CAVtBrF,IAUsB,QAVtBA,IAUsB,CATtBE,SASsB,QATtBA,SASsB,CARtBE,mBAQsB,QARtBA,mBAQsB,CAPtB+C,gBAOsB,QAPtBA,gBAOsB,CANtBxC,kBAMsB,QANtBA,kBAMsB;AACtB;;AAEA;AACA;AACA;AACA;;AAEA;AACE;AACGwC,IAAAA,gBAAgB,CAACkC,WAAD,CAAhB,CAA8BxO,GAA9B,CAAkC,UAAC+G,IAAD,EAAO+G,KAAP,EAAiB;AAClD;AACE,4BAAC,aAAD;AACE,UAAA,GAAG,sBAAeA,KAAf,CADL;AAEE,UAAA,OAAO,EAAEzR,OAFX;AAGE,UAAA,mBAAmB,EAAEkN,mBAHvB;AAIE,UAAA,SAAS,EAAEzC,QAAQ,CAAC,CAACuC,SAAD,CAAD,CAJrB;AAKE,UAAA,IAAI,EAAEF,IALR;AAME,UAAA,IAAI,EAAEpC,IANR;AAOE,UAAA,kBAAkB,EAAE+C,kBAPtB,GADF;;;AAWD,KAZA,CADH,CADF;;;AAiBD,CAtC4B,CAAtB;;ACgCP,IAAM2E,WAAW,GAAG,KAAK,EAAzB;AACA,IAAMC,mBAAmB,GAAG,CAA5B;AACA,IAAMtK,KAAK,GAAG,SAARA,KAAQ,CAAChH,CAAD,UAAuBA,CAAC,GAAGsR,mBAA3B,EAAd;AACA,IAAMxJ,GAAG,GAAG,SAANA,GAAM,CAACyJ,IAAD,UAA0BA,IAAI,GAAGD,mBAAjC,EAAZ;AACA,IAAME,WAAW,GAAG,CAAC,KAAD,EAAQ,WAAR,CAApB;;AAEA,IAAaC,iBAAiB,gBAAGhT,KAAK,CAACC,IAAN,CAAW,SAAS+S,iBAAT;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEzC,kCAnEDC,iBAmEC,CAnEDA,iBAmEC,sCAnEmB,EAmEnB,sDAlEDC,2BAkEC,CAlEDA,2BAkEC,sCAlE6B,EAkE7B,sDAjEDC,kBAiEC,CAjEDA,kBAiEC,sCAjEoBD,2BAiEpB,yBAhED9Q,KAgEC,QAhEDA,KAgEC,CA/DDgR,QA+DC,QA/DDA,QA+DC,wBA9DDlL,UA8DC,CA9DWmL,WA8DX,gCA9DyB,IAAIf,IAAJ,EA8DzB,4CA7DDgB,YA6DC,CA7DDA,YA6DC,kCA7Dc,CAAC,CAAD,EAAI,EAAJ,CA6Dd,qBA5DD9S,OA4DC,QA5DDA,OA4DC,CA3DDgN,SA2DC,QA3DDA,SA2DC,CA1DDC,QA0DC,QA1DDA,QA0DC,CAzDD8F,YAyDC,QAzDDA,YAyDC,CAxDDxF,qBAwDC,QAxDDA,qBAwDC,CAvDDE,kBAuDC,QAvDDA,kBAuDC,CAtDDxN,QAsDC,QAtDDA,QAsDC,CArDD+S,YAqDC,QArDDA,YAqDC,CApDDC,QAoDC,QApDDA,QAoDC,CAnDDd,WAmDC,QAnDDA,WAmDC;AACD,MAAMtH,MAAM,GAAGmI,YAAY,KAAK,IAAjB,GAAwBE,EAAxB,GAA6BpI,EAA5C;AACA,MAAMqI,YAAY,GAAGF,QAAQ,GAAG,CAAH,GAAO,CAApC;AACA,MAAMvL,UAAU,GAAGqG,OAAO,CAAC,oBAAM9E,UAAU,CAAC4J,WAAD,CAAhB,EAAD,EAAgC,CAACA,WAAD,CAAhC,CAA1B;AACA,MAAMjM,gBAAgB,GAAGwL,WAAW,GAAGK,iBAAvC;AACA,MAAM5L,kBAAkB,GAAGsM,YAAY,GAAGd,mBAA1C;AACA,MAAM5K,KAAK,GAAGlC,WAAW,CAAC,UAACvE,CAAD,UAAeA,CAAC,GAAGyR,iBAAnB,EAAD,EAAuC;AAC9DA,EAAAA,iBAD8D,CAAvC,CAAzB;;AAGA,MAAM3J,GAAG,GAAGvD,WAAW,CAAC,UAAC6N,IAAD,UAA0BA,IAAI,GAAGX,iBAAjC,EAAD,EAAqD;AAC1EA,EAAAA,iBAD0E,CAArD,CAAvB;;;AAIA,MAAMY,oBAAoB,GAAGtF,OAAO,CAAC,YAAM;AACzC,WAAOlG,qCAAqC,CAAC;AAC3CH,MAAAA,UAAU,EAAVA,UAD2C;AAE3CI,MAAAA,KAAK,EAAEL,KAFoC;AAG3CO,MAAAA,KAAK,EAAED,KAHoC,EAAD,CAA5C;;AAKD,GANmC,EAMjC,CAACN,KAAD,EAAQC,UAAR,CANiC,CAApC;;AAQA,MAAM4L,yBAAyB,GAAG/N,WAAW;AAC3C,YAACmF,IAAD,EAA+B;AACJ2I,IAAAA,oBAAoB,CAAC3I,IAAD,CADhB,0DACtBY,KADsB,6BACZiI,IADY;AAE7B3E,IAAAA,SAAS;AACP2E,IAAAA,IAAI,CAACtF,MAAL,KAAgB,CADT;AAEsEsF,IAAAA,IAAI,CAACtF,MAF3E,4FAAT;;;;AAMA,WAAO3C,KAAP;AACD,GAV0C;AAW3C,GAAC+H,oBAAD,CAX2C,CAA7C;;;AAcA,MAAMpD,gBAAgB,GAAGlC,OAAO,CAAC,YAAM;AACrC,WAAOnF,yBAAyB,CAAC;AAC/BlB,MAAAA,UAAU,EAAVA,UAD+B;AAE/Bd,MAAAA,gBAAgB,EAAhBA,gBAF+B;AAG/BC,MAAAA,kBAAkB,EAAlBA,kBAH+B;AAI/BgC,MAAAA,GAAG,EAAHA,GAJ+B;AAK/BC,MAAAA,GAAG,EAAHA,GAL+B,EAAD,CAAhC;;AAOD,GAR+B,EAQ7B,CAACA,GAAD,EAAMlC,gBAAN,EAAwBC,kBAAxB,EAA4Ca,UAA5C,CAR6B,CAAhC;;AAUA,MAAM8L,IAAI,GAAG3N,MAAM,CAAwB,IAAxB,CAAnB;AACA,MAAM4N,MAAM,GAAG5N,MAAM,CAAwB,IAAxB,CAArB;;AAEA,MAAMsL,IAAI,GAAGuC,gBAAgB,CAACD,MAAD,CAA7B,CAhDC;;;;;;;AAuDGnS,EAAAA,eAAe,CAACmS,MAAD,EAASxT,QAAT,CAvDlB,CAkDQ0T,YAlDR,oBAkDC/R,KAlDD,CAmDCE,GAnDD,oBAmDCA,GAnDD,CAoDCE,UApDD,oBAoDCA,UApDD,CAqDCE,mBArDD,oBAqDCA,mBArDD,CAsDCoD,MAtDD,oBAsDCA,MAtDD;;;;AA2DG9D,EAAAA,QAAQ,CAA4B,IAA5B,CA3DX,2CAyDCoS,eAzDD,iBA0DCC,kBA1DD;;AA6DkDrS,EAAAA,QAAQ,CAAC,CAAC,CAAD,EAAI,CAAJ,CAAD,CA7D1D,2FA6DOkF,WA7DP,kBA6DoBC,UA7DpB,kBA6DiCmN,aA7DjC;;AA+DD,MAAMC,sBAAsB,GAAI,KAAK,EAAN,GAAYrB,2BAA3C;;AAEArQ,EAAAA,SAAS;AACP,WAAS2R,2CAAT,GAAuD;AACrD,QAAI,CAACP,MAAM,CAACrR,OAAZ,EAAqB;AACnB0R,MAAAA,aAAa,CAAC,CAAC,CAAD,EAAI,CAAJ,CAAD,CAAb;AACA;AACD;;AAEDA,IAAAA,aAAa,CAAC,CAACL,MAAM,CAACrR,OAAP,CAAesC,YAAhB,EAA8B+O,MAAM,CAACrR,OAAP,CAAeoC,WAA7C,CAAD,CAAb;AACD,GARM;AASP,GAAC2M,IAAD,EAAO4C,sBAAP,CATO,CAAT;;;AAYA,MAAMjH,IAAI,GAAGiB,OAAO,CAAc,YAAM;AACtC,QAAIrH,WAAW,KAAK,IAAhB,IAAwBC,UAAU,KAAK,IAA3C,EAAiD;AAC/C,aAAO,IAAP;AACD;;AAED,WAAOF,UAAU,CAAC;AAChBC,MAAAA,WAAW,EAAXA,WADgB;AAEhBC,MAAAA,UAAU,EAAVA,UAFgB;AAGhBE,MAAAA,kBAAkB,EAAlBA,kBAHgB;AAIhBD,MAAAA,gBAAgB,EAAhBA,gBAJgB,EAAD,CAAjB;;AAMD,GAXmB,EAWjB,CAACF,WAAD,EAAcC,UAAd,EAA0BE,kBAA1B,EAA8CD,gBAA9C,CAXiB,CAApB;;AAaAvE,EAAAA,SAAS;AACP,WAAS4R,oCAAT,GAAgD;AAC9C,QAAInH,IAAI,KAAK,IAAT,IAAiBhL,GAAG,KAAK,IAA7B,EAAmC;AACjC+R,MAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACA;AACD;;AAED,QAAMnJ,IAAI,GAAGoC,IAAI,CAAC1F,eAAL,CAAqBtF,GAArB,CAAb;AACA,QAAMoS,UAAU,GAAGb,oBAAoB,CAAC3I,IAAD,CAAvC;AACA,QAAMpK,KAAK,GAAG4T,UAAd;AACAL,IAAAA,kBAAkB,CAACvT,KAAD,CAAlB;AACD,GAXM;AAYP,GAACwB,GAAD,EAAMgL,IAAN,EAAYuG,oBAAZ,EAAkCvK,GAAlC,CAZO,CAAT,CA1FC;;;AAyGwDtH,EAAAA,QAAQ;;AAE/D,GAAC,IAAD,EAAO,IAAP,CAF+D,CAzGhE,2FAyGO2S,gBAzGP,kBAyGyBC,eAzGzB,kBAyG2CC,SAzG3C;;AA6GDhS,EAAAA,SAAS;AACP,WAASiS,mCAAT,GAA+C;AAC7C,QAAIrU,QAAJ,EAAc;AACZ;AACD;;AAED,QAAIiC,mBAAJ,EAAyB;AACvB,UAAI0R,eAAJ,EAAqB;AACnB3G,QAAAA,QAAQ,8BAAK2F,QAAL,sBAAkBgB,eAAlB,GAAR;AACD;AACDC,MAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACD;AACF,GAZM;AAaP;AACE3R,EAAAA,mBADF;AAEEjC,EAAAA,QAFF;AAGEgN,EAAAA,QAHF;AAIE4G,EAAAA,kBAJF;AAKED,EAAAA,eALF;AAMEhB,EAAAA,QANF,CAbO,CAAT;;;;AAuBAvQ,EAAAA,SAAS;AACP,WAASkS,6BAAT,GAAyC;AACvC,QAAIX,eAAe,KAAK,IAAxB,EAA8B;AAC5BS,MAAAA,SAAS,CAAC,CAAC,IAAD,EAAO,IAAP,CAAD,CAAT;AACD;AACF,GALM;AAMP,GAACT,eAAD,CANO,CAAT;;;AASA,MAAMY,iBAAiB,GAAGjP,WAAW;AACnC,YAACkP,YAAD,EAAe1U,UAAf,EAA8B;AAC5B,QAAIE,QAAJ,EAAc;AACZ;AACD;;AAED,QAAI,CAAC2S,QAAD,IAAa6B,YAAjB,EAA+B;AAC7BxH,MAAAA,QAAQ,CAAC,CAACwH,YAAD,CAAD,CAAR;;AAEA;AACD;;AAED,QAAIC,WAAW,sBAAO9B,QAAP,CAAf;;AAEA,QAAI,CAAC6B,YAAL,EAAmB;AACjBC,MAAAA,WAAW,CAACC,MAAZ,CAAmB5U,UAAnB,EAA+B,CAA/B;AACD,KAFD,MAEO;AACL;AACE6U,MAAAA,WAAW,CAACH,YAAY,CAAC,CAAD,CAAb,EAAkBC,WAAW,CAAC3U,UAAD,CAAX,CAAwB,CAAxB,CAAlB,CAAX;AACA6U,MAAAA,WAAW,CAACH,YAAY,CAAC,CAAD,CAAb,EAAkBC,WAAW,CAAC3U,UAAD,CAAX,CAAwB,CAAxB,CAAlB,CAFb;AAGE;AACA;AACD;AACD2U,MAAAA,WAAW,CAAC3U,UAAD,CAAX,GAA0B0U,YAA1B;AACD;;AAEDxH,IAAAA,QAAQ,CAACyH,WAAD,CAAR;AACD,GA3BkC;AA4BnC,GAAC9B,QAAD,EAAW3F,QAAX,EAAqBhN,QAArB,CA5BmC,CAArC;;;AA+BAuF,EAAAA,YAAY;AACV,OADU;AAEV,WAASqP,WAAT,GAAuB;AACrB,QAAIjB,eAAJ,EAAqB;AACnBtO,MAAAA,MAAM;AACP;AACF,GANS;AAOVS,EAAAA,QAPU,CAAZ;;;AAUA,MAAMuH,WAAW,GAAG/H,WAAW;AAC7B,mBAA+B,KAA5BxF,UAA4B,SAA5BA,UAA4B,CAAhBD,SAAgB,SAAhBA,SAAgB;AAC7B,WAAOC,UAAU,KAAKoU,gBAAf,IAAmCrU,SAAS,KAAKsU,eAAxD;AACD,GAH4B;AAI7B,GAACA,eAAD,EAAkBD,gBAAlB,CAJ6B,CAA/B;;;AAOA,MAAMtU,YAAY,GAAG0F,WAAW;AAC9B,YAACpE,CAAD,EAA8B;AAC5B,QAAIgT,gBAAgB,KAAK,IAArB,IAA6BlU,QAAjC,EAA2C;AACzC;AACD;;AAEDkB,IAAAA,CAAC,CAACC,cAAF;AACAD,IAAAA,CAAC,CAACE,eAAF;AACAmT,IAAAA,iBAAiB,CAACrF,SAAD,EAAYgF,gBAAZ,CAAjB;AACD,GAT6B;AAU9B,GAACA,gBAAD,EAAmBlU,QAAnB,EAA6BuU,iBAA7B,CAV8B,CAAhC;;;AAaAhP,EAAAA,YAAY,CAAC+M,WAAD,EAAc1S,YAAd,EAA4B2T,IAA5B,CAAZ;;AAEAnR,EAAAA,SAAS;AACP,WAASyS,iCAAT,GAA6C;AAC3CxP,IAAAA,MAAM;AACP,GAHM;AAIP,GAAC6L,IAAD,EAAO7L,MAAP,CAJO,CAAT;;;AAOA,MAAM+E,yBAAyB,GAAG0D,OAAO,CAAC,YAAM;AAC9C,WAAOlG,qCAAqC,CAAC;AAC3CH,MAAAA,UAAU,EAAVA,UAD2C;AAE3CM,MAAAA,KAAK,EAAED,KAFoC;AAG3CD,MAAAA,KAAK,EAAE,eAAA9G,CAAC,UAAIA,CAAC,GAAG0R,2BAAR;AACR;AACA;AAL2C,KAAD,CAA5C;AAOD,GARwC,EAQtC,CAACA,2BAAD,EAA8BhL,UAA9B,CARsC,CAAzC;;AAUArF,EAAAA,SAAS;AACP,WAAS0S,uBAAT,GAAmC;AACjC,QAAI,CAAChP,QAAQ,CAACiP,aAAd,EAA6B;AAC3B;AACD;;AAED,QAAI,CAACxB,IAAI,CAACpR,OAAN,IAAiB,CAACoR,IAAI,CAACpR,OAAL,CAAa6S,QAAb,CAAsBlP,QAAQ,CAACiP,aAA/B,CAAtB,EAAqE;AACnE;AACD;;AAEDE,IAAAA,cAAc,CAACnP,QAAQ,CAACiP,aAAV,EAAyB;AACrCG,MAAAA,UAAU,EAAE,WADyB;AAErCC,MAAAA,KAAK,EAAE,SAF8B;AAGrCC,MAAAA,MAAM,EAAE,SAH6B,EAAzB,CAAd;;AAKD,GAfM;AAgBP,GAACzC,QAAD,CAhBO,CAAT,CA7NC;;;AAgPiEpR,EAAAA,QAAQ;AACxE,OADwE,CAhPzE,4CAgPM8T,yBAhPN,iBAgPiCC,4BAhPjC;;;AAoPDlT,EAAAA,SAAS;AACP,WAASmT,oBAAT,GAAgC;AAC9B,QAAIF,yBAAyB,IAAI,CAAC9B,IAAI,CAACpR,OAAnC,IAA8C,CAAC0K,IAAnD,EAAyD;AACvD;AACD;;AAED,QAAM5E,KAAK,GAAG+H,gBAAgB;AAC5BpG,IAAAA,oBAAoB,CAAC+I,QAAD,CAApB,IAAkC;AAChC6C,IAAAA,QAAQ,CAAC/N,UAAD,EAAaoL,YAAY,CAAC,CAAD,CAAzB,CADwB;AAEhC2C,IAAAA,QAAQ,CAAC/N,UAAD,EAAaoL,YAAY,CAAC,CAAD,CAAzB,CAFwB;AAGhC,MAHgC;AAIhC,MAJgC,CADN,CAA9B;;;AAQA,QAAM/N,IAAI,GAAG+H,IAAI,CAAC9F,eAAL,CAAqBkB,KAAK,CAAC,CAAD,CAA1B,CAAb,CAb8B;AActBrH,IAAAA,GAdsB,GAcNkE,IAdM,CActBlE,GAdsB,CAcjB8D,MAdiB,GAcNI,IAdM,CAcjBJ,MAdiB;;AAgB9B,QAAI9D,GAAG,KAAK,CAAR,IAAa8D,MAAM,KAAK,CAA5B,EAA+B;AAC7B;AACD;;AAED;AACA,QAAI,EAAE,cAAc6O,IAAI,CAACpR,OAArB,CAAJ,EAAmC;AACjC;AACD;;AAEDoR,IAAAA,IAAI,CAACpR,OAAL,CAAasT,QAAb,CAAsB,CAAtB,EAAyB7U,GAAzB;;AAEA0U,IAAAA,4BAA4B,CAAC,IAAD,CAA5B;AACD,GA7BM;AA8BP;AACED,EAAAA,yBADF;AAEExI,EAAAA,IAFF;AAGE8F,EAAAA,QAHF;AAIEE,EAAAA,YAJF;AAKEpL,EAAAA,UALF;AAMEuI,EAAAA,gBANF,CA9BO,CAAT;;;;AAwCA,MAAM0F,UAAmC,GAAGpQ,WAAW;AACrD,YAAAjF,KAAK,EAAI;AACP,QAAI,CAACA,KAAK,CAACsV,MAAN,CAAaX,QAAb,CAAsBlP,QAAQ,CAACiP,aAA/B,CAAL,EAAoD;AAClDX,MAAAA,SAAS,CAAC,CAAC,IAAD,EAAO,IAAP,CAAD,CAAT;AACD;AACF,GALoD;AAMrD,GAACA,SAAD,CANqD,CAAvD;;;AASA,MAAMwB,eAAe,GAAGtQ,WAAW;AACjC,YAACuQ,QAAD,EAAmB3L,SAAnB,UAAyC,UAAC7J,KAAD,EAA6B;AACpE,UAAI,CAACwM,IAAD,IAAS7M,QAAb,EAAuB;AACrB;AACD;;AAED,UAAMkH,KAAK,GAAG2B,GAAG,CAAC6J,kBAAD,CAAjB;AACA,UAAMjI,IAAI,GAAG;AACXxG,QAAAA,MAAM,EAAE4R,QADG;AAEXzR,QAAAA,MAAM,EAAE8F,SAFG;AAGX7F,QAAAA,IAAI,EAAEwR,QAHK;AAIXrR,QAAAA,IAAI,EAAE0C,KAAK,GAAGgD,SAJH;AAKXhD,QAAAA,KAAK,EAALA,KALW;AAMXD,QAAAA,KAAK,EAAEb,OAAO,CAACyP,QAAD,EAAWA,QAAX,CANH;AAOXjR,QAAAA,MAAM,EAAE,EAPG;AAQXC,QAAAA,KAAK,EAAE,EARI,EAAb;;;AAWA,UAAMoP,UAAU,GAAGb,oBAAoB,CAAC3I,IAAD,CAAvC;;AAEAmJ,MAAAA,kBAAkB,CAACK,UAAD,CAAlB;;AAEA5T,MAAAA,KAAK,CAACe,eAAN;AACAf,MAAAA,KAAK,CAACc,cAAN;AACD,KAvBD,EADiC;AAyBjC,GAAC0L,IAAD,EAAO7M,QAAP,EAAiB6I,GAAjB,EAAsB6J,kBAAtB,EAA0CU,oBAA1C,CAzBiC,CAAnC;;;AA4BA;AACE;AACE,MAAA,GAAG,EAAEG,IADP;AAEE,MAAA,KAAK,EAAE5R,KAFT;AAGE,MAAA,MAAM,EAAE+T,UAHV;AAIE,sBAAc3T,UAAU,GAAG,MAAH,GAAYmN,SAJtC;AAKE,MAAA,SAAS,EAAE1E,QAAQ,CAAC;AAClBzK,MAAAA,OAAO,CAACwT,IADU;AAElBxT,MAAAA,OAAO,CAAC+V,KAFU;AAGlB/I,MAAAA,SAHkB;AAIfhN,MAAAA,OAAO,CAAC,WAAD,CAJQ,EAIQgC,UAJR,EAAD,CALrB;;;AAYE,iCAAK,SAAS,EAAEhC,OAAO,CAAC,WAAD,CAAvB;AACE;AACE,yBADF;AAEE,MAAA,SAAS,EAAEyK,QAAQ,CAAC,CAACzK,OAAO,CAACgW,QAAT,EAAmBhW,OAAO,CAAC,aAAD,CAA1B,CAAD,CAFrB;;AAIE,iCAAK,SAAS,EAAEA,OAAO,CAACiW,MAAxB;AACE,iCAAK,SAAS,EAAEjW,OAAO,CAAC,YAAD,CAAvB;AACE,iCAAK,SAAS,EAAEyK,QAAQ,CAAC,CAACzK,OAAO,CAAC0K,IAAT,EAAe1K,OAAO,CAAC8E,KAAvB,CAAD,CAAxB,QADF,CADF,CAJF;;;AASE,iCAAK,SAAS,EAAE9E,OAAO,CAACkW,QAAxB;AACE,iCAAK,SAAS,EAAElW,OAAO,CAAC,YAAD,CAAvB;AACE,iCAAK,SAAS,EAAEA,OAAO,CAAC,WAAD,CAAvB;AACGmW,IAAAA,KAAK,CAACpC,sBAAD,CAAL,CAA8BpQ,GAA9B,CAAkC,UAAAwG,SAAS,EAAI;AAC9C;AACE,4BAAC,IAAD;AACE,UAAA,OAAO,EAAEnK,OADX;AAEE,UAAA,yBAAyB,EAAEqK,yBAF7B;AAGE,UAAA,GAAG,EAAEF,SAHP;AAIE,UAAA,SAAS,EAAEA,SAJb;;AAMG,yBAA4B,KAAzBnH,KAAyB,SAAzBA,KAAyB,CAAlBuH,WAAkB,SAAlBA,WAAkB;AAC3B,cAAIA,WAAJ,EAAiB;AACf;AACE,2CAAK,SAAS,EAAEvK,OAAO,CAACoW,IAAxB;AACG/K,cAAAA,MAAM,CAACrI,KAAD,EAAQ,OAAR,EAAiB,EAAE6H,MAAM,EAANA,MAAF,EAAjB,CADT,CADF;;;AAKD;;AAED,iBAAO,IAAP;AACD,SAhBH,CADF;;;AAoBD,KArBA,CADH,CADF,CADF,CATF,CADF;;;;;AAuCE;AACE,MAAA,SAAS,EAAEJ,QAAQ,CAAC;AAClBzK,MAAAA,OAAO,CAAC,YAAD,CADW;AAElBA,MAAAA,OAAO,CAAC,gBAAD,CAFW,CAAD,CADrB;;;AAME;AACE,MAAA,IAAI,EAAC,cADP;AAEE,MAAA,SAAS,EAAEyK,QAAQ,CAAC,CAACzK,OAAO,CAACkW,QAAT,EAAmBlW,OAAO,CAACiW,MAA3B,CAAD,CAFrB;;AAIGE,IAAAA,KAAK,CAAChD,YAAD,CAAL,CAAoBxP,GAApB,CAAwB,UAAAwE,CAAC;AACxB;AACE,UAAA,GAAG,EAAEA,CADP;AAEE,UAAA,IAAI,EAAC,cAFP;AAGE,UAAA,SAAS,EAAEnI,OAAO,CAAC,YAAD,CAHpB;;AAKE;AACE,UAAA,SAAS,EAAEyK,QAAQ,CAAC;AAClBzK,UAAAA,OAAO,CAAC0K,IADU;AAElB1K,UAAAA,OAAO,CAAC8E,KAFU;AAGf9E,UAAAA,OAAO,CAAC,SAAD,CAHQ,EAGM6R,MAAM,CAACjK,OAAO,CAACF,UAAD,EAAaS,CAAb,CAAR,CAHZ;;AAKfnI,UAAAA,OAAO,CAAC,YAAD,CALQ,EAKSqW,OAAO,CAACzO,OAAO,CAACF,UAAD,EAAaS,CAAb,CAAR,CALhB,EAAD,CADrB;;;;AAUE;AACGkD,QAAAA,MAAM,CAACzD,OAAO,CAACF,UAAD,EAAaS,CAAb,CAAR,EAAyB,MAAzB,EAAiC,EAAE0C,MAAM,EAANA,MAAF,EAAjC,CADT,CAVF;;AAaE;AACGQ,QAAAA,MAAM,CAACzD,OAAO,CAACF,UAAD,EAAaS,CAAb,CAAR,EAAyB,MAAzB,EAAiC,EAAE0C,MAAM,EAANA,MAAF,EAAjC,CADT,CAbF;;AAgBE,sCAAM,SAAS,EAAE7K,OAAO,CAACoL,IAAzB;AACGC,QAAAA,MAAM,CAACzD,OAAO,CAACF,UAAD,EAAaS,CAAb,CAAR,EAAyB,GAAzB,EAA8B,EAAE0C,MAAM,EAANA,MAAF,EAA9B,CADT,CAhBF,CALF,CADwB,GAAzB,CAJH,CANF,CAvCF;;;;;;;AA+EE,iCAAK,SAAS,EAAE7K,OAAO,CAAC,iBAAD,CAAvB;AACGgC,IAAAA,UAAU;AACT,iCAAK,SAAS,EAAEhC,OAAO,CAAC,UAAD,CAAvB,EAAqC,KAAK,EAAE2T,YAA5C;AACGzR,IAAAA,mBAAmB,iBAAI,6BAAK,SAAS,EAAElC,OAAO,CAACsW,KAAxB,GAD1B,CAFJ;;;AAMGxJ,IAAAA,IAAI,IAAI8G,eAAR,IAA2B5R,UAA3B;AACC,wBAAC,QAAD;AACE,MAAA,OAAO,EAAEhC,OADX;AAEE,MAAA,gBAAgB,EAAEiQ,gBAFpB;AAGE,MAAA,mBAAmB,EAAEqD,yBAHvB;AAIE,MAAA,SAAS,EAAEtT,OAAO,CAAC,qBAAD,CAJpB;AAKE,MAAA,MAAM,+BAAM4S,QAAN,sBAAmBgB,eAAnB,EALR;AAME,MAAA,IAAI,EAAE9G,IANR;AAOE,MAAA,QAAQ,EAAC,MAPX;AAQE,MAAA,qBAAqB,EAAES,qBARzB;AASE,MAAA,WAAW,EAAED,WATf,GAPJ;;;AAmBGR,IAAAA,IAAI,IAAI,CAAC8G,eAAT;AACC,wBAAC,QAAD;AACE,MAAA,OAAO,EAAE5T,OADX;AAEE,MAAA,cAAc,EAAEqU,SAFlB;AAGE,MAAA,gBAAgB,EAAEpE,gBAHpB;AAIE,MAAA,mBAAmB,EAAEqD,yBAJvB;AAKE,MAAA,WAAW,MALb;AAME,MAAA,QAAQ,EAAC,GANX;AAOE,MAAA,WAAW,MAPb;AAQE,MAAA,QAAQ,EAAEkB,iBARZ;AASE,MAAA,OAAO,EAAEzB,YATX;AAUE,MAAA,MAAM,EAAEH,QAVV;AAWE,MAAA,IAAI,EAAE9F,IAXR;AAYE,MAAA,qBAAqB,EAAES,qBAZzB;AAaE,MAAA,kBAAkB,EAAEE,kBAbtB;AAcE,MAAA,WAAW,EAAEH,WAdf;AAeE,MAAA,QAAQ,EAAErN,QAfZ,GApBJ;;;AAsCG6M,IAAAA,IAAI;AACH,wBAAC,aAAD;AACE,MAAA,GAAG,sBAAeqF,WAAf,CADL;AAEE,MAAA,OAAO,EAAEnS,OAFX;AAGE,MAAA,gBAAgB,EAAEiQ,gBAHpB;AAIE,MAAA,mBAAmB,EAAEqD,yBAJvB;AAKE,MAAA,WAAW;AACRnB,MAAAA,WANL;;AAQE,MAAA,IAAI,EAAErF,IARR,GAvCJ;;;;AAmDE,iCAAK,GAAG,EAAE2G,MAAV,EAAkB,IAAI,EAAC,MAAvB,EAA8B,SAAS,EAAEzT,OAAO,CAACkW,QAAjD;AACGC,IAAAA,KAAK,CAAChD,YAAD,CAAL,CAAoBxP,GAApB,CAAwB,UAAAmS,QAAQ,EAAI;AACnC,UAAMS,QAAQ,GAAG1E,MAAM,CAACjK,OAAO,CAACF,UAAD,EAAaoO,QAAQ,GAAG,CAAxB,CAAR,CAAvB;AACA;AACE;AACE,UAAA,IAAI,EAAC,UADP;AAEE,UAAA,GAAG,EAAEA,QAFP;AAGE,UAAA,SAAS,EAAE9V,OAAO,CAAC,YAAD,CAHpB;;AAKE;AACE,UAAA,SAAS,EAAEyK,QAAQ,CAAC;AAClBzK,UAAAA,OAAO,CAAC,WAAD,CADW;;AAGfA,UAAAA,OAAO,CAAC,SAAD,CAHQ,EAGMuW,QAHN,EAAD,CADrB;;;;AAQGJ,QAAAA,KAAK,CAACpC,sBAAD,CAAL,CAA8BpQ,GAA9B,CAAkC,UAAAwG,SAAS,EAAI;AAC9C;AACE,gCAAC,IAAD;AACE,cAAA,OAAO,EAAEnK,OADX;AAEE,cAAA,OAAO;AACL,eAACuW,QAAD;AACIV,cAAAA,eAAe;AACbC,cAAAA,QADa;AAEb3L,cAAAA,SAAS;AACNvD,cAAAA,gBAAgB,GAAGmN,sBADb,CAFI,CADnB;;AAMI5E,cAAAA,SATR;;AAWE,cAAA,yBAAyB,EAAE9E,yBAX7B;AAYE,cAAA,GAAG,EAAEF,SAZP;AAaE,cAAA,SAAS,EAAEA,SAbb,GADF;;;AAiBD,SAlBA,CARH,CALF,CADF;;;;AAoCD,KAtCA,CADH,CAnDF,CA/EF,CAZF,CADF;;;;;;AA4LD,CAjkBgC,EAikB9BR,OAjkB8B,CAA1B;;;;;;"}